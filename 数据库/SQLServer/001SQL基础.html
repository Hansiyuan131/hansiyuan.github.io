<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL基础 | 7Tree技术栈</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="icon" href="/favicon-32x32.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="Talk is cheap. Show me the code">
    <meta name="theme-color" content="#ffffff">
    <link rel="preload" href="/assets/css/0.styles.9983b828.css" as="style"><link rel="preload" href="/assets/js/app.d214fd8d.js" as="script"><link rel="preload" href="/assets/js/2.cb1efa29.js" as="script"><link rel="preload" href="/assets/js/39.9b5993f0.js" as="script"><link rel="preload" href="/assets/js/6.180eae89.js" as="script"><link rel="preload" href="/assets/js/3.86630006.js" as="script"><link rel="prefetch" href="/assets/js/10.da01beaf.js"><link rel="prefetch" href="/assets/js/11.60832861.js"><link rel="prefetch" href="/assets/js/12.46b7f824.js"><link rel="prefetch" href="/assets/js/13.c05dbbd3.js"><link rel="prefetch" href="/assets/js/14.0849ab08.js"><link rel="prefetch" href="/assets/js/15.0260603f.js"><link rel="prefetch" href="/assets/js/16.b5ce1d69.js"><link rel="prefetch" href="/assets/js/17.ee70ad0f.js"><link rel="prefetch" href="/assets/js/18.9fb72237.js"><link rel="prefetch" href="/assets/js/19.197e4423.js"><link rel="prefetch" href="/assets/js/20.b7bab479.js"><link rel="prefetch" href="/assets/js/21.631097a2.js"><link rel="prefetch" href="/assets/js/22.588f1f99.js"><link rel="prefetch" href="/assets/js/23.f7db75a2.js"><link rel="prefetch" href="/assets/js/24.d0a92f37.js"><link rel="prefetch" href="/assets/js/25.192929e4.js"><link rel="prefetch" href="/assets/js/26.29747567.js"><link rel="prefetch" href="/assets/js/27.6a14665e.js"><link rel="prefetch" href="/assets/js/28.8469c569.js"><link rel="prefetch" href="/assets/js/29.0e598ce7.js"><link rel="prefetch" href="/assets/js/30.f61888cd.js"><link rel="prefetch" href="/assets/js/31.64af9460.js"><link rel="prefetch" href="/assets/js/32.dc7e7034.js"><link rel="prefetch" href="/assets/js/33.feb9522f.js"><link rel="prefetch" href="/assets/js/34.596872ca.js"><link rel="prefetch" href="/assets/js/35.15df2c18.js"><link rel="prefetch" href="/assets/js/36.ebacaa49.js"><link rel="prefetch" href="/assets/js/37.1c9fe52f.js"><link rel="prefetch" href="/assets/js/38.6438cdde.js"><link rel="prefetch" href="/assets/js/4.6c41b86e.js"><link rel="prefetch" href="/assets/js/40.1f56a9ff.js"><link rel="prefetch" href="/assets/js/41.a6cb7f4b.js"><link rel="prefetch" href="/assets/js/42.0eac2a2b.js"><link rel="prefetch" href="/assets/js/43.7996f5e9.js"><link rel="prefetch" href="/assets/js/44.34b76eef.js"><link rel="prefetch" href="/assets/js/45.3cb593b0.js"><link rel="prefetch" href="/assets/js/46.de2ed787.js"><link rel="prefetch" href="/assets/js/47.b1887ae2.js"><link rel="prefetch" href="/assets/js/48.251cb371.js"><link rel="prefetch" href="/assets/js/49.f343c36e.js"><link rel="prefetch" href="/assets/js/5.40452514.js"><link rel="prefetch" href="/assets/js/50.17564016.js"><link rel="prefetch" href="/assets/js/51.d080457d.js"><link rel="prefetch" href="/assets/js/52.512ded93.js"><link rel="prefetch" href="/assets/js/53.86243de8.js"><link rel="prefetch" href="/assets/js/54.2767f2c2.js"><link rel="prefetch" href="/assets/js/55.91793e75.js"><link rel="prefetch" href="/assets/js/56.b4c5bebd.js"><link rel="prefetch" href="/assets/js/57.f20ec28d.js"><link rel="prefetch" href="/assets/js/58.e6079be9.js"><link rel="prefetch" href="/assets/js/7.4d402272.js"><link rel="prefetch" href="/assets/js/8.2f37510a.js"><link rel="prefetch" href="/assets/js/9.09359b4b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9983b828.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/icons/icon-72x72.png" alt="7Tree技术栈" class="logo"> <span class="site-name can-hide">7Tree技术栈</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/项目/iMall/" class="nav-link">
  iMall
</a></li><li class="dropdown-item"><!----> <a href="/项目/sn-reader/" class="nav-link">
  sn-reader
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          后端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/后端/JavaBlog/" class="nav-link">
  JavaBlog
</a></li><li class="dropdown-subitem"><a href="/后端/NetBlog/" class="nav-link">
  NetBlog
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端/Vue/" class="nav-link">
  VueBlog
</a></li><li class="dropdown-subitem"><a href="/前端/React/" class="nav-link">
  ReactBlog
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><span class="title">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/爬虫/" class="nav-link">
  爬虫
</a></li><li class="dropdown-item"><!----> <a href="/Python/人工智能/" class="nav-link">
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/Python/量化分析/" class="nav-link">
  量化分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/算法/算法基础/" class="nav-link">
  数据结构+算法
</a></li></ul></li><li class="dropdown-item"><h4>
          练习
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/算法/LeetCode/" class="nav-link">
  LeetCode
</a></li><li class="dropdown-subitem"><a href="/算法/剑指Offer/" class="nav-link">
  剑指Offer
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/数据库/Mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/数据库/SQLServer/" class="nav-link">
  SQLServer
</a></li><li class="dropdown-item"><!----> <a href="/数据库/Redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/数据库/MongoDB/" class="nav-link">
  MongoDB
</a></li></ul></div></div><div class="nav-item"><a href="/DevOps/" class="nav-link">
  DevOps
</a></div><div class="nav-item"><a href="/每月小记/" class="nav-link">
  每月小记
</a></div><div class="nav-item"><a href="/关于我/" class="nav-link">
  关于我
</a></div><div class="nav-item"><a href="/读书/" class="nav-link">
  读书
</a></div><div class="nav-item"><a href="/常用导航/" class="nav-link">
  常用导航
</a></div><div class="nav-item"><a href="/其他/" class="nav-link">
  其他
</a></div> <a href="https://github.com/Hansiyuan131/hansiyuan131.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/项目/iMall/" class="nav-link">
  iMall
</a></li><li class="dropdown-item"><!----> <a href="/项目/sn-reader/" class="nav-link">
  sn-reader
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          后端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/后端/JavaBlog/" class="nav-link">
  JavaBlog
</a></li><li class="dropdown-subitem"><a href="/后端/NetBlog/" class="nav-link">
  NetBlog
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端/Vue/" class="nav-link">
  VueBlog
</a></li><li class="dropdown-subitem"><a href="/前端/React/" class="nav-link">
  ReactBlog
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><span class="title">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/爬虫/" class="nav-link">
  爬虫
</a></li><li class="dropdown-item"><!----> <a href="/Python/人工智能/" class="nav-link">
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/Python/量化分析/" class="nav-link">
  量化分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/算法/算法基础/" class="nav-link">
  数据结构+算法
</a></li></ul></li><li class="dropdown-item"><h4>
          练习
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/算法/LeetCode/" class="nav-link">
  LeetCode
</a></li><li class="dropdown-subitem"><a href="/算法/剑指Offer/" class="nav-link">
  剑指Offer
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/数据库/Mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/数据库/SQLServer/" class="nav-link">
  SQLServer
</a></li><li class="dropdown-item"><!----> <a href="/数据库/Redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/数据库/MongoDB/" class="nav-link">
  MongoDB
</a></li></ul></div></div><div class="nav-item"><a href="/DevOps/" class="nav-link">
  DevOps
</a></div><div class="nav-item"><a href="/每月小记/" class="nav-link">
  每月小记
</a></div><div class="nav-item"><a href="/关于我/" class="nav-link">
  关于我
</a></div><div class="nav-item"><a href="/读书/" class="nav-link">
  读书
</a></div><div class="nav-item"><a href="/常用导航/" class="nav-link">
  常用导航
</a></div><div class="nav-item"><a href="/其他/" class="nav-link">
  其他
</a></div> <a href="https://github.com/Hansiyuan131/hansiyuan131.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>SQLServer</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/SQLServer/" aria-current="page" class="sidebar-link">SQLServer</a></li><li><a href="/数据库/SQLServer/001SQL基础.html" class="active sidebar-link">SQL基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql基础语句" class="sidebar-link">SQL基础语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-语法" class="sidebar-link">SQL 语法</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-select-语句" class="sidebar-link">SQL SELECT 语句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-select-distinct-语句" class="sidebar-link">SQL SELECT DISTINCT 语句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#where-子句" class="sidebar-link">WHERE 子句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#and-和-or-运算符" class="sidebar-link">AND 和 OR 运算符</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#order-by-语句" class="sidebar-link">ORDER BY 语句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#insert-into-语句" class="sidebar-link">INSERT INTO 语句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#update-语句" class="sidebar-link">Update 语句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#delete-语句" class="sidebar-link">DELETE 语句</a></li></ul></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql高级语句" class="sidebar-link">SQL高级语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#top-子句" class="sidebar-link">TOP 子句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-like" class="sidebar-link">SQL like</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-通配符" class="sidebar-link">SQL 通配符</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-in" class="sidebar-link">SQL in</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-between" class="sidebar-link">SQL between</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-alias-别名" class="sidebar-link">SQL Alias(别名)</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-join" class="sidebar-link">SQL join</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-inner-join" class="sidebar-link">SQL inner join</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-left-join" class="sidebar-link">SQL LEFT join</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-right-join" class="sidebar-link">SQL right join</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-full-join" class="sidebar-link">SQL full join</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-union" class="sidebar-link">SQL union</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-select-into" class="sidebar-link">SQL select into</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-create-database" class="sidebar-link">SQL create database</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-create-table" class="sidebar-link">SQL create table</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-约束" class="sidebar-link">SQL 约束</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-not-null" class="sidebar-link">SQL not null</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-unique" class="sidebar-link">SQL unique</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-primary-key" class="sidebar-link">SQL primary key</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-foreign-key" class="sidebar-link">SQL foreign key</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-check" class="sidebar-link">SQL check</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-default" class="sidebar-link">SQL default</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-create-index" class="sidebar-link">SQL create index</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-drop" class="sidebar-link">SQL drop</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-alter" class="sidebar-link">SQL alter</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-increment" class="sidebar-link">SQL increment</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-view" class="sidebar-link">SQL view</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-date" class="sidebar-link">SQL date</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-null" class="sidebar-link">SQL NULL</a></li></ul></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-数据类型" class="sidebar-link">SQL 数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#microsoft-access-数据类型" class="sidebar-link">Microsoft Access 数据类型</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#mysql-数据类型" class="sidebar-link">MySQL 数据类型</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-server-数据类型" class="sidebar-link">SQL Server 数据类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql函数" class="sidebar-link">SQL函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-aggregate-functions" class="sidebar-link">SQL Aggregate functions</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#scalar-函数" class="sidebar-link">Scalar 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-avg-函数" class="sidebar-link">SQL AVG 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-count-函数" class="sidebar-link">SQL COUNT() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-first-函数" class="sidebar-link">SQL FIRST() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-last-函数" class="sidebar-link">SQL LAST() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-max-函数" class="sidebar-link">SQL MAX() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-min-函数" class="sidebar-link">SQL MIN() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-group-by-语句" class="sidebar-link">SQL GROUP BY 语句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-having-子句" class="sidebar-link">SQL HAVING 子句</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-ucase-函数" class="sidebar-link">SQL UCASE() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-lcase-函数" class="sidebar-link">SQL LCASE() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-mid-函数" class="sidebar-link">SQL MID() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-len-函数" class="sidebar-link">SQL LEN() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-round-函数" class="sidebar-link">SQL ROUND() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-now-函数" class="sidebar-link">SQL NOW() 函数</a></li><li class="sidebar-sub-header"><a href="/数据库/SQLServer/001SQL基础.html#sql-format-函数" class="sidebar-link">SQL FORMAT() 函数</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sql基础"><a href="#sql基础" class="header-anchor">#</a> SQL基础</h1> <h2 id="sql基础语句"><a href="#sql基础语句" class="header-anchor">#</a> SQL基础语句</h2> <h3 id="sql-语法"><a href="#sql-语法" class="header-anchor">#</a> SQL 语法</h3> <h4 id="数据库表"><a href="#数据库表" class="header-anchor">#</a> 数据库表</h4> <p>一个数据库通常包含一个或多个表。每个表由一个名字标识（例如“客户”或者“订单”）。表包含带有数据
的记录（行）。
下面的例子是一个名为 &quot;Persons&quot; 的表：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>上面的表包含三条记录（每一条对应一个人）和五个列（Id、姓、名、地址和城市）。</p> <h4 id="sql-语句"><a href="#sql-语句" class="header-anchor">#</a> SQL 语句</h4> <p>您需要在数据库上执行的大部分工作都由 SQL 语句完成。</p> <p>下面的语句从表中选取 LastName 列的数据：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LastName <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>LastName</th></tr></thead> <tbody><tr><td>Adams</td></tr> <tr><td>Bush</td></tr> <tr><td>Carter</td></tr></tbody></table> <p><strong>SQL 对大小写不敏感！</strong></p> <p>SQL 语句后面的分号？</p> <p>某些数据库系统要求在每条 SQL 命令的末端使用分号。分号是在数据库系统中分隔每条 SQL 语句的标准方法，这样就可以在对服务器的相同请求中执行一条以上的语句。如果您使用的是<code>MS Access</code> 和 <code>SQL Server 2000</code>，则不必在每条 SQL 语句之后使用分号，不过某些数据库软件要求必须使用分号。</p> <p><strong>SQL DML 和 DDL</strong></p> <p>可以把 SQL 分为两个部分：数据操作语言 (DML) 和 数据定义语言 (DDL)。</p> <p>SQL (结构化查询语言)是用于执行查询的语法。但是 SQL 语言也包含用于更新、插入和删除记录的语法。
查询和更新指令构成了 SQL 的 DML 部分：· SELECT - 从数据库表中获取数据</p> <ul><li><code>UPDATE</code> - 更新数据库表中的数据</li> <li><code>DELETE</code> - 从数据库表中删除数据</li> <li><code>INSERT INTO</code> - 向数据库表中插入数据</li></ul> <p>SQL 的数据定义语言 (DDL) 部分使我们有能力创建或删除表格。我们也可以定义索引（键），规定表之
间的链接，以及施加表间的约束。</p> <p>SQL 中最重要的 DDL 语句:</p> <ul><li><code>CREATE DATABASE</code> - 创建新数据库</li> <li><code>ALTER DATABASE</code> - 修改数据库</li> <li><code>CREATE TABLE</code> - 创建新表</li> <li><code>ALTER TABLE</code> - 变更（改变）数据库表</li> <li><code>DROP TABLE</code> - 删除表</li> <li><code>CREATE INDEX</code> - 创建索引（搜索键）</li> <li><code>DROP INDEX</code> - 删除索引</li></ul> <hr> <h3 id="sql-select-语句"><a href="#sql-select-语句" class="header-anchor">#</a> SQL SELECT 语句</h3> <p>SELECT 语句用于从表中选取数据。结果被存储在一个结果表中（称为结果集）。</p> <p>SQL SELECT 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 列名称 <span class="token keyword">FROM</span> 表名称
</code></pre></div><p>以及：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> 表名称
注释：<span class="token keyword">SQL</span> 语句对大小写不敏感。<span class="token keyword">SELECT</span> 等效于 <span class="token keyword">select</span>。
</code></pre></div><p>SQL SELECT 实例</p> <p>如需获取名为 &quot;LastName&quot; 和 &quot;FirstName&quot; 的列的内容（从名为 &quot;Persons&quot; 的数据库表），请使用类似这样的 SELECT 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LastName<span class="token punctuation">,</span>FirstName <span class="token keyword">FROM</span> Persons
</code></pre></div><p>&quot;Persons&quot; 表:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td></tr> <tr><td>Bush</td> <td>George</td></tr> <tr><td>Carter</td> <td>Thomas</td></tr></tbody></table> <p>SQL SELECT * 实例</p> <p>现在我们希望从 &quot;Persons&quot; 表中选取所有的列。提示：星号（*）是选取所有列的快捷方式。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>在结果集（result-set）中导航<br>
由 SQL 查询程序获得的结果被存放在一个结果集中。大多数数据库软件系统都允许使用编程函数在结果
集中进行导航，比如：<code>Move-To-First-Record</code>、<code>Get-Record-Content</code>、<code>Move-To-Next-Record</code> 等等。</p> <hr> <h3 id="sql-select-distinct-语句"><a href="#sql-select-distinct-语句" class="header-anchor">#</a> SQL SELECT DISTINCT 语句</h3> <p>在表中，可能会包含重复值。这并不成问题，不过，有时您也许希望仅仅列出不同（distinct）的值。<br>
关键词 DISTINCT 用于返回唯一不同的值。<br>
语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> 列名称 <span class="token keyword">FROM</span> 表名称
</code></pre></div><p>使用 DISTINCT 关键词<br>
如果要从 &quot;Company&quot; 列中选取所有的值，我们需要使用 SELECT 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Company <span class="token keyword">FROM</span> Orders
</code></pre></div><p>&quot;Orders&quot;表：</p> <table><thead><tr><th>Company</th> <th>OrderNumber</th></tr></thead> <tbody><tr><td>IBM</td> <td>3532</td></tr> <tr><td>W3CSchool</td> <td>2356</td></tr> <tr><td>Apple</td> <td>4698</td></tr> <tr><td>W3CSchool</td> <td>6953</td></tr></tbody></table> <p>结果：</p> <table><thead><tr><th>Company</th></tr></thead> <tbody><tr><td>IBM</td></tr> <tr><td>W3CSchool</td></tr> <tr><td>Apple</td></tr> <tr><td>W3CSchool</td></tr></tbody></table> <p>请注意，在结果集中，W3CSchool 被列出了两次。
如需从 Company&quot; 列中仅选取唯一不同的值，我们需要使用 SELECT DISTINCT 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Company <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果：</p> <table><thead><tr><th>Company</th></tr></thead> <tbody><tr><td>IBM</td></tr> <tr><td>W3CSchool</td></tr> <tr><td>Apple</td></tr></tbody></table> <p>现在，在结果集中，&quot;W3CSchool&quot; 仅被列出了一次。</p> <hr> <h3 id="where-子句"><a href="#where-子句" class="header-anchor">#</a> WHERE 子句</h3> <p>如需有条件地从表中选取数据，可将 WHERE 子句添加到 SELECT 语句。<br>
语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 列名称 <span class="token keyword">FROM</span> 表名称 <span class="token keyword">WHERE</span> 列 运算符 值
</code></pre></div><p>下面的运算符可在 WHERE 子句中使用：</p> <table><thead><tr><th>操作符</th> <th>描述</th></tr></thead> <tbody><tr><td>=</td> <td>等于</td></tr> <tr><td>&lt;&gt;</td> <td>不等于</td></tr> <tr><td>&gt;</td> <td>大于</td></tr> <tr><td>&lt;</td> <td>小于</td></tr> <tr><td>&gt;=</td> <td>大于等于</td></tr> <tr><td>&lt;=</td> <td>小于等于</td></tr> <tr><td>BETWEEN</td> <td>在某个范围内</td></tr> <tr><td>LIKE</td> <td>搜索某种模式</td></tr></tbody></table> <p>注释：在某些版本的 SQL 中，操作符 &lt;&gt; 可以写为 !=。</p> <p>使用 WHERE 子句</p> <p>如果只希望选取居住在城市 &quot;Beijing&quot; 中的人，我们需要向 SELECT 语句添加 WHERE 子句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City<span class="token operator">=</span><span class="token string">'Beijing'</span>
</code></pre></div><p>&quot;Persons&quot; 表</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th> <th>Year</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td> <td>1970</td></tr> <tr><td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td> <td>1975</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td> <td>1980</td></tr> <tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td> <td>1985</td></tr></tbody></table> <p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th> <th>Year</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td> <td>1980</td></tr> <tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td> <td>1985</td></tr></tbody></table> <p>引号的使用(请注意，我们在例子中的条件值周围使用的是单引号。)</p> <p>SQL 使用单引号来环绕文本值（大部分数据库系统也接受双引号）。如果是数值，请不要使用引号。<br>
文本值：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>这是正确的：
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> FirstName<span class="token operator">=</span><span class="token string">'Bush'</span>
这是错误的：
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> FirstName<span class="token operator">=</span>Bush
</code></pre></div><p>数值：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>这是正确的：
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> <span class="token keyword">Year</span><span class="token operator">&gt;</span><span class="token number">1965</span>
这是错误的：
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> <span class="token keyword">Year</span><span class="token operator">&gt;</span><span class="token string">'1965'</span>
</code></pre></div><hr> <h3 id="and-和-or-运算符"><a href="#and-和-or-运算符" class="header-anchor">#</a> AND 和 OR 运算符</h3> <p>AND 和 OR 运算符用于基于一个以上的条件对记录进行过滤。</p> <p>AND 和 OR 可在 WHERE 子语句中把两个或多个条件结合起来。</p> <p>如果第一个条件和第二个条件都成立，则 AND 运算符显示一条记录。<br>
如果第一个条件和第二个条件中只要有一个成立，则 OR 运算符显示一条记录。</p> <p>原始的表 (用在例子中的)：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>Carter</td> <td>William</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <p>AND 运算符实例</p> <p>使用 AND 来显示所有姓为 &quot;Carter&quot; 并且名为 &quot;Thomas&quot; 的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> FirstName<span class="token operator">=</span><span class="token string">'Thomas'</span> <span class="token operator">AND</span> LastName<span class="token operator">=</span><span class="token string">'Carter'</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>OR 运算符实例
使用 OR 来显示所有姓为 &quot;Carter&quot; 或者名为 &quot;Thomas&quot; 的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> firstname<span class="token operator">=</span><span class="token string">'Thomas'</span> <span class="token operator">OR</span> lastname<span class="token operator">=</span><span class="token string">'Carter'</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>Carter</td> <td>William</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <p>结合 AND 和 OR 运算符<br>
我们也可以把 AND 和 OR 结合起来（使用圆括号来组成复杂的表达式）:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> <span class="token punctuation">(</span>FirstName<span class="token operator">=</span><span class="token string">'Thomas'</span> <span class="token operator">OR</span> FirstName<span class="token operator">=</span><span class="token string">'William'</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> LastName<span class="token operator">=</span><span class="token string">'Carter'</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>Carter</td> <td>William</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <hr> <h3 id="order-by-语句"><a href="#order-by-语句" class="header-anchor">#</a> ORDER BY 语句</h3> <p>ORDER BY 语句用于对结果集进行排序。</p> <p>ORDER BY 语句用于根据指定的列对结果集进行排序。ORDER BY 语句默认按照升序对记录进行排序。
如果您希望按照降序对记录进行排序，可以使用 DESC 关键字。</p> <p>Orders 表:</p> <table><thead><tr><th>Company</th> <th>OrderNumber</th></tr></thead> <tbody><tr><td>IBM</td> <td>3532</td></tr> <tr><td>W3CSchool</td> <td>2356</td></tr> <tr><td>Apple</td> <td>4698</td></tr> <tr><td>W3CSchool</td> <td>6953</td></tr></tbody></table> <p>以字母顺序显示公司名称：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Company<span class="token punctuation">,</span> OrderNumber <span class="token keyword">FROM</span> Orders <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Company
</code></pre></div><p>结果：</p> <table><thead><tr><th>Company</th> <th>OrderNumber</th></tr></thead> <tbody><tr><td>Apple</td> <td>4698</td></tr> <tr><td>IBM</td> <td>3532</td></tr> <tr><td>W3CSchool</td> <td>6953</td></tr> <tr><td>W3CSchool</td> <td>2356</td></tr></tbody></table> <p>以字母顺序显示公司名称（Company），并以数字顺序显示顺序号（OrderNumber）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Company<span class="token punctuation">,</span> OrderNumber <span class="token keyword">FROM</span> Orders <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Company<span class="token punctuation">,</span> OrderNumber
</code></pre></div><p>结果：</p> <table><thead><tr><th>Company</th> <th>OrderNumber</th></tr></thead> <tbody><tr><td>Apple 4698IBM</td> <td>3532</td></tr> <tr><td>W3CSchool</td> <td>2356</td></tr> <tr><td>W3CSchool</td> <td>6953</td></tr></tbody></table> <p>以逆字母顺序显示公司名称：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Company<span class="token punctuation">,</span> OrderNumber <span class="token keyword">FROM</span> Orders <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Company <span class="token keyword">DESC</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>Company</th> <th>OrderNumber</th></tr></thead> <tbody><tr><td>W3CSchool</td> <td>6953</td></tr> <tr><td>W3CSchool</td> <td>2356</td></tr> <tr><td>IBM</td> <td>3532</td></tr> <tr><td>Apple</td> <td>4698</td></tr></tbody></table> <p>以逆字母顺序显示公司名称，并以数字顺序显示顺序号：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Company<span class="token punctuation">,</span> OrderNumber <span class="token keyword">FROM</span> Orders <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Company <span class="token keyword">DESC</span><span class="token punctuation">,</span>
OrderNumber <span class="token keyword">ASC</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>Company</th> <th>OrderNumber</th></tr></thead> <tbody><tr><td>W3CSchool</td> <td>2356</td></tr> <tr><td>W3CSchool</td> <td>6953</td></tr> <tr><td>IBM</td> <td>3532</td></tr> <tr><td>Apple</td> <td>4698</td></tr></tbody></table> <p>注意：在以上的结果中有两个相等的公司名称 (W3CSchool)。只有这一次，在第一列中有相同的值时，第二列是以升序排列的。如果第一列中有些值为 nulls 时，情况也是这样的。</p> <hr> <h3 id="insert-into-语句"><a href="#insert-into-语句" class="header-anchor">#</a> INSERT INTO 语句</h3> <p>INSERT INTO 语句用于向表格中插入新的行。</p> <p>语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 表名称 <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>值 <span class="token number">1</span><span class="token punctuation">,</span> 值 <span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><p>我们也可以指定所要插入数据的列：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table_name <span class="token punctuation">(</span>列 <span class="token number">1</span><span class="token punctuation">,</span> 列 <span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>值 <span class="token number">1</span><span class="token punctuation">,</span> 值 <span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><p>插入新的行</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>SQL 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Gates'</span><span class="token punctuation">,</span> <span class="token string">'Bill'</span><span class="token punctuation">,</span> <span class="token string">'Xuanwumen 10'</span><span class="token punctuation">,</span> <span class="token string">'Beijing'</span><span class="token punctuation">)</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <p>在指定的列中插入数据</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <p>SQL 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>LastName<span class="token punctuation">,</span> Address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Wilson'</span><span class="token punctuation">,</span> <span class="token string">'Champs-Elysees'</span><span class="token punctuation">)</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr> <tr><td>Wilson</td> <td></td> <td>Champs-Elysees</td> <td></td></tr></tbody></table> <hr> <h3 id="update-语句"><a href="#update-语句" class="header-anchor">#</a> Update 语句</h3> <p>Update 语句用于修改表中的数据。</p> <p>语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> 表名称 <span class="token keyword">SET</span> 列名称 <span class="token operator">=</span> 新值 <span class="token keyword">WHERE</span> 列名称 <span class="token operator">=</span> 某值
</code></pre></div><p>Person:</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr> <tr><td>Wilson</td> <td></td> <td>Champs-Elysees</td> <td></td></tr></tbody></table> <p>更新某一行中的一个列</p> <p>我们为 lastname 是 &quot;Wilson&quot; 的人添加 firstname：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> Person <span class="token keyword">SET</span> FirstName <span class="token operator">=</span> <span class="token string">'Fred'</span> <span class="token keyword">WHERE</span> LastName <span class="token operator">=</span> <span class="token string">'Wilson'</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr> <tr><td>Wilson</td> <td>Fred</td> <td>Champs-Elysees</td> <td></td></tr></tbody></table> <p>更新某一行中的若干列</p> <p>我们会修改地址（address），并添加城市名称（city）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> Person <span class="token keyword">SET</span> Address <span class="token operator">=</span> <span class="token string">'Zhongshan 23'</span><span class="token punctuation">,</span> City <span class="token operator">=</span> <span class="token string">'Nanjing'</span>
<span class="token keyword">WHERE</span> LastName <span class="token operator">=</span> <span class="token string">'Wilson'</span>
</code></pre></div><p>结果：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr> <tr><td>Wilson</td> <td>Fred</td> <td>Zhongshan 23</td> <td>Nanjing</td></tr></tbody></table> <hr> <h3 id="delete-语句"><a href="#delete-语句" class="header-anchor">#</a> DELETE 语句</h3> <p>DELETE 语句用于删除表中的行。</p> <p>语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> 表名称 <span class="token keyword">WHERE</span> 列名称 <span class="token operator">=</span> 值
</code></pre></div><p>Person:</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr> <tr><td>Wilson</td> <td>Fred</td> <td>Zhongshan 23</td> <td>Nanjing</td></tr></tbody></table> <p>删除某行</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token string">&quot;Fred Wilson&quot;</span> 会被删除：<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> Person <span class="token keyword">WHERE</span> LastName <span class="token operator">=</span> <span class="token string">'Wilson'</span>
</code></pre></div><p>结果:</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <p>删除所有行</p> <p>可以在不删除表的情况下删除所有的行。这意味着表的结构、属性和索引都是完整的：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>或者：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><hr> <h2 id="sql高级语句"><a href="#sql高级语句" class="header-anchor">#</a> SQL高级语句</h2> <hr> <h3 id="top-子句"><a href="#top-子句" class="header-anchor">#</a> TOP 子句</h3> <p><strong>TOP 子句用于规定要返回的记录的数目。对于拥有数千条记录的大型表来说，TOP 子句是非常有用的。</strong></p> <p>注释：并非所有的数据库系统都支持 TOP 子句。</p> <p>SQL Server 的语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> number<span class="token operator">|</span><span class="token keyword">percent</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
</code></pre></div><p>MySQL 和 Oracle 中的 SQL SELECT TOP 是等价的

MySQL 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">LIMIT</span> number
</code></pre></div><p>例子</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token keyword">FROM</span> Persons <span class="token keyword">LIMIT</span> <span class="token number">5</span>
</code></pre></div><p>Oracle 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> ROWNUM <span class="token operator">&lt;=</span> number
</code></pre></div><p>例子</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> ROWNUM <span class="token operator">&lt;=</span> <span class="token number">5</span>
</code></pre></div><p>Persons 表:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>4</td> <td>Obama</td> <td>Barack</td> <td>Pennsylvania Avenue</td> <td>Washington</td></tr></tbody></table> <p>SQL TOP 实例</p> <p>现在，我们希望从上面的 &quot;Persons&quot; 表中选取头两条记录。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr></tbody></table> <p>SQL TOP PERCENT 实例</p> <p>现在，我们希望从上面的 &quot;Persons&quot; 表中选取 50% 的记录。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">50</span> <span class="token keyword">PERCENT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr></tbody></table> <hr> <h3 id="sql-like"><a href="#sql-like" class="header-anchor">#</a> SQL like</h3> <p><strong>LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式。</strong></p> <p>LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式。</p> <p>SQL LIKE 操作符语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> column_name <span class="token operator">LIKE</span> pattern
</code></pre></div><p>Persons 表:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Addressv</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>LIKE 操作符实例</p> <p>现在，我们希望从上面的 &quot;Persons&quot; 表中选取居住在以 &quot;N&quot; 开始的城市里的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> PersonsWHERE City <span class="token operator">LIKE</span> <span class="token string">'N%'</span>
提示：<span class="token string">&quot;%&quot;</span> 可用于定义通配符（模式中缺少的字母）。
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenuev</td> <td>New York</td></tr></tbody></table> <p>接下来，我们希望从 &quot;Persons&quot; 表中选取居住在以 &quot;g&quot; 结尾的城市里的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City <span class="token operator">LIKE</span> <span class="token string">'%g'</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>3 vCarter vThomasv Changan Street</td> <td>Beijing</td> <td></td> <td></td> <td></td></tr></tbody></table> <p>接下来，我们希望从 &quot;Persons&quot; 表中选取居住在包含 &quot;lon&quot; 的城市里的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City <span class="token operator">LIKE</span> <span class="token string">'%lon%'</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr></tbody></table> <p>通过使用 NOT 关键字，我们可以从 &quot;Persons&quot; 表中选取居住在不包含 &quot;lon&quot; 的城市里的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">'%lon%'</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <hr> <h3 id="sql-通配符"><a href="#sql-通配符" class="header-anchor">#</a> SQL 通配符</h3> <p><strong>在搜索数据库中的数据时，SQL 通配符可以替代一个或多个字符。SQL 通配符必须与 LIKE 运算符一起使用。</strong></p> <p>在 SQL 中，可使用以下通配符：</p> <table><thead><tr><th>通配符</th> <th>描述</th></tr></thead> <tbody><tr><td>%</td> <td>替代一个或多个字符</td></tr> <tr><td>_</td> <td>仅替代一个字符</td></tr> <tr><td>[charlist][^charlist]或者[!charlist]</td> <td>字符列中的任何单一字符</td></tr></tbody></table> <p>不在字符列中的任何单一字符</p> <p>Persons 表:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <h4 id="使用-通配符"><a href="#使用-通配符" class="header-anchor">#</a> 使用 % 通配符</h4> <p>现在，我们希望从上面的 &quot;Persons&quot; 表中选取居住在以 &quot;Ne&quot; 开始的城市里的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City <span class="token operator">LIKE</span> <span class="token string">'Ne%'</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr></tbody></table> <p>接下来，我们希望从 &quot;Persons&quot; 表中选取居住在包含 &quot;lond&quot; 的城市里的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City <span class="token operator">LIKE</span> <span class="token string">'%lond%'</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr></tbody></table> <h5 id="使用-通配符-2"><a href="#使用-通配符-2" class="header-anchor">#</a> 使用 _ 通配符</h5> <p>现在，我们希望从上面的 &quot;Persons&quot; 表中选取名字的第一个字符之后是 &quot;eorge&quot; 的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> FirstName <span class="token operator">LIKE</span> <span class="token string">'_eorge'</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr></tbody></table> <p>接下来，我们希望从 &quot;Persons&quot; 表中选取的这条记录的姓氏以 &quot;C&quot; 开头，然后是一个任意字符，然后是&quot;r&quot;，然后是任意字符，然后是 &quot;er&quot;：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> LastName <span class="token operator">LIKE</span> <span class="token string">'C_r_er'</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <h5 id="使用-charlist-通配符"><a href="#使用-charlist-通配符" class="header-anchor">#</a> 使用 [charlist] 通配符</h5> <p>现在，我们希望从上面的 &quot;Persons&quot; 表中选取居住的城市以 &quot;A&quot; 或 &quot;L&quot; 或 &quot;N&quot; 开头的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City <span class="token operator">LIKE</span> <span class="token string">'[ALN]%'</span>

</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr></tbody></table> <p>现在，我们希望从上面的 &quot;Persons&quot; 表中选取居住的城市不以 &quot;A&quot; 或 &quot;L&quot; 或 &quot;N&quot; 开头的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> PersonsWHERE City <span class="token operator">LIKE</span> <span class="token string">'[!ALN]%'</span>

</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <hr> <h3 id="sql-in"><a href="#sql-in" class="header-anchor">#</a> SQL in</h3> <p>IN 操作符允许我们在 WHERE 子句中规定多个值。</p> <p>SQL IN 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> column_name <span class="token operator">IN</span> <span class="token punctuation">(</span>value1<span class="token punctuation">,</span>value2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

</code></pre></div><p>Persons 表:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>现在，我们希望从上表中选取姓氏为 Adams 和 Carter 的人：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> LastName <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'Adams'</span><span class="token punctuation">,</span><span class="token string">'Carter'</span><span class="token punctuation">)</span>

</code></pre></div><table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <hr> <h3 id="sql-between"><a href="#sql-between" class="header-anchor">#</a> SQL between</h3> <p>BETWEEN 操作符在 WHERE 子句中使用，作用是选取介于两个值之间的数据范围。操作符 BETWEEN ... AND 会选取介于两个值之间的数据范围。这些值可以是数值、文本或者日期。</p> <p>SQL BETWEEN 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> column_name <span class="token operator">BETWEEN</span> value1 <span class="token operator">AND</span> value2

</code></pre></div><p>Persons 表:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>4</td> <td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <p>如需以字母顺序显示介于 **&quot;Adams&quot;（包括）和 &quot;Carter&quot;（不包括）**之间的人，请使用下面的 SQL：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> PersonsWHERE LastName <span class="token operator">BETWEEN</span> <span class="token string">'Adams'</span> <span class="token operator">AND</span> <span class="token string">'Carter'</span>

</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr></tbody></table> <p>重要事项：不同的数据库对 BETWEEN...AND 操作符的处理方式是有差异的。某些数据库会列出介于&quot;Adams&quot; 和 &quot;Carter&quot; 之间的人，但不包括 &quot;Adams&quot; 和 &quot;Carter&quot; ；某些数据库会列出介于 &quot;Adams&quot;和 &quot;Carter&quot; 之间并包括 &quot;Adams&quot; 和 &quot;Carter&quot; 的人；而另一些数据库会列出介于 &quot;Adams&quot; 和&quot;Carter&quot; 之间的人，包括 &quot;Adams&quot; ，但不包括 &quot;Carter&quot; 。所以，请检查你的数据库是如何处理BETWEEN....AND 操作符的！</p> <p>如需使用上面的例子显示范围之外的人，请使用 NOT 操作符：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> LastName <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token string">'Adams'</span> <span class="token operator">AND</span> <span class="token string">'Carter'</span>

</code></pre></div><p>结果集：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr> <tr><td>4</td> <td>Gates</td> <td>Bill</td> <td>Xuanwumen 10</td> <td>Beijing</td></tr></tbody></table> <hr> <h3 id="sql-alias-别名"><a href="#sql-alias-别名" class="header-anchor">#</a> SQL Alias(别名)</h3> <p>通过使用 SQL，可以为列名称和表名称指定别名（Alias）。</p> <p>表的 SQL Alias 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">AS</span> alias_name

</code></pre></div><p>列的 SQL Alias 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name <span class="token keyword">AS</span> alias_name <span class="token keyword">FROM</span> table_name

</code></pre></div><p>假设我们有两个表分别是：&quot;Persons&quot; 和 &quot;Product_Orders&quot;。我们分别为它们指定别名 &quot;p&quot; 和 &quot;po&quot;。
现在，我们希望列出 &quot;John Adams&quot; 的所有定单。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> po<span class="token punctuation">.</span>OrderID<span class="token punctuation">,</span> p<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> p<span class="token punctuation">.</span>FirstName
<span class="token keyword">FROM</span> Persons <span class="token keyword">AS</span> p<span class="token punctuation">,</span> Product_Orders <span class="token keyword">AS</span> po
<span class="token keyword">WHERE</span> p<span class="token punctuation">.</span>LastName<span class="token operator">=</span><span class="token string">'Adams'</span> <span class="token operator">AND</span> p<span class="token punctuation">.</span>FirstName<span class="token operator">=</span><span class="token string">'John'</span>

</code></pre></div><p>不使用别名的 SELECT 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Product_Orders<span class="token punctuation">.</span>OrderID<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName
<span class="token keyword">FROM</span> Persons<span class="token punctuation">,</span> Product_Orders
<span class="token keyword">WHERE</span> Persons<span class="token punctuation">.</span>LastName<span class="token operator">=</span><span class="token string">'Adams'</span> <span class="token operator">AND</span> Persons<span class="token punctuation">.</span>FirstName<span class="token operator">=</span><span class="token string">'John'</span>

</code></pre></div><p>使用一个列名别名
表 Persons:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>SQL:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LastName <span class="token keyword">AS</span> Family<span class="token punctuation">,</span> FirstName <span class="token keyword">AS</span> Name <span class="token keyword">FROM</span> Persons

</code></pre></div><p>结果：</p> <table><thead><tr><th>Family</th> <th>Name</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td></tr> <tr><td>Bush</td> <td>George</td></tr> <tr><td>Carter</td> <td>Thomas</td></tr></tbody></table> <hr> <h3 id="sql-join"><a href="#sql-join" class="header-anchor">#</a> SQL join</h3> <p>SQL join 用于根据两个或多个表中的列之间的关系，从这些表中查询数据。</p> <p>Join 和 Key</p> <p>有时为了得到完整的结果，我们需要从两个或更多的表中获取结果。我们就需要执行 join。数据库中的表可通过键将彼此联系起来。主键（Primary Key）是一个列，在这个列中的每一行的值都是唯一的。在表中，每个主键的值都是唯一的。这样做的目的是在不重复每个表中的所有数据的情况下，把表间的数据交叉捆绑在一起。</p> <p>&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id_P</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>请注意，&quot;Id_P&quot; 列是 Persons 表中的的主键。这意味着没有两行能够拥有相同的 Id_P。即使两个人的
姓名完全相同，Id_P 也可以区分他们。</p> <p>接下来请看 &quot;Orders&quot; 表：</p> <table><thead><tr><th>Id_O</th> <th>OrderNo</th> <th>Id_P</th></tr></thead> <tbody><tr><td>1</td> <td>77895</td> <td>3</td></tr> <tr><td>2</td> <td>44678</td> <td>3</td></tr> <tr><td>3</td> <td>22456</td> <td>1</td></tr> <tr><td>4</td> <td>24562</td> <td>1</td></tr> <tr><td>5</td> <td>34764</td> <td>65</td></tr></tbody></table> <p>请注意，&quot;Id_O&quot; 列是 Orders 表中的的主键，同时，&quot;Orders&quot; 表中的 &quot;Id_P&quot; 列用于引用&quot;Persons&quot;表中的人，而无需使用他们的确切姓名。</p> <p>请留意，&quot;Id_P&quot; 列把上面的两个表联系了起来。我们可以通过引用两个表的方式，从两个表中获取数据：</p> <p>谁订购了产品，并且他们订购了什么产品？</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderNo <span class="token keyword">FROM</span> Persons<span class="token punctuation">,</span> Orders <span class="token keyword">WHERE</span> Persons<span class="token punctuation">.</span>Id_P <span class="token operator">=</span> Orders<span class="token punctuation">.</span>Id_P

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>OrderNo</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>22456</td></tr> <tr><td>Adams</td> <td>John</td> <td>24562</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>77895</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>44678</td></tr></tbody></table> <p>除了上面的方法，我们也可以使用关键词 JOIN 来从两个表中获取数据。</p> <p>如果我们希望列出所有人的定购，可以使用下面的 SELECT 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderNo <span class="token keyword">FROM</span> Persons 
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Orders <span class="token keyword">ON</span> Persons<span class="token punctuation">.</span>Id_P <span class="token operator">=</span> Orders<span class="token punctuation">.</span>Id_P
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Persons<span class="token punctuation">.</span>LastName

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>OrderNo</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>22456</td></tr> <tr><td>Adams</td> <td>John</td> <td>24562</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>77895</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>44678</td></tr></tbody></table> <p>不同的 SQL JOIN 除了我们在上面的例子中使用的 INNER JOIN（内连接），我们还可以其他几种连接。</p> <p>下面列出了您可以使用的 JOIN 类型，以及它们之间的差异。</p> <ul><li>JOIN: 如果表中有至少一个匹配，则返回行</li> <li>LEFT JOIN: 即使右表中没有匹配，也从左表返回所有的行</li> <li>RIGHT JOIN: 即使左表中没有匹配，也从右表返回所有的行</li> <li>FULL JOIN: 只要其中一个表中存在匹配，就返回行</li></ul> <hr> <h3 id="sql-inner-join"><a href="#sql-inner-join" class="header-anchor">#</a> SQL inner join</h3> <p>在表中存在至少一个匹配时，INNER JOIN 关键字返回行。</p> <p>INNER JOIN 关键字语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name1
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> table_name2 <span class="token keyword">ON</span> table_name1<span class="token punctuation">.</span>column_name<span class="token operator">=</span>table_name2<span class="token punctuation">.</span>column_name
注释：<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> 与 <span class="token keyword">JOIN</span> 是相同的。

</code></pre></div><p>原始的表 (用在例子中的)：
&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id_P</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>Id_O</th> <th>OrderNo</th> <th>Id_P</th></tr></thead> <tbody><tr><td>1</td> <td>77895</td> <td>3</td></tr> <tr><td>2</td> <td>44678</td> <td>3</td></tr> <tr><td>3</td> <td>22456</td> <td>1</td></tr> <tr><td>4</td> <td>24562</td> <td>1</td></tr> <tr><td>5</td> <td>34764</td> <td>65</td></tr></tbody></table> <p>内连接（INNER JOIN）实例
现在，我们希望列出所有人的定购。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderNo <span class="token keyword">FROM</span> Persons
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Orders <span class="token keyword">ON</span> Persons<span class="token punctuation">.</span>Id_P<span class="token operator">=</span>Orders<span class="token punctuation">.</span>Id_P
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Persons<span class="token punctuation">.</span>LastName

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>OrderNo</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>22456</td></tr> <tr><td>Adams</td> <td>John</td> <td>24562</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>77895</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>44678</td></tr></tbody></table> <p>INNER JOIN 关键字在表中存在至少一个匹配时返回行。如果 &quot;Persons&quot; 中的行在 &quot;Orders&quot; 中没有匹
配，就不会列出这些行。</p> <hr> <h3 id="sql-left-join"><a href="#sql-left-join" class="header-anchor">#</a> SQL LEFT join</h3> <p>LEFT JOIN 关键字会从左表 (table_name1) 那里返回所有的行，即使在右表 (table_name2) 中没有
匹配的行。</p> <p>LEFT JOIN 关键字语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> table_name2 <span class="token keyword">ON</span> table_name1<span class="token punctuation">.</span>column_name<span class="token operator">=</span>table_name2<span class="token punctuation">.</span>column_name
注释：在某些数据库中， <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 称为 <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>。

</code></pre></div><p>&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id_P</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>Id_O</th> <th>OrderNo</th> <th>Id_P</th></tr></thead> <tbody><tr><td>1</td> <td>77895</td> <td>3</td></tr> <tr><td>2</td> <td>44678</td> <td>3</td></tr> <tr><td>3</td> <td>22456</td> <td>1</td></tr> <tr><td>4</td> <td>24562</td> <td>1</td></tr> <tr><td>5</td> <td>34764</td> <td>65</td></tr></tbody></table> <p>左连接（LEFT JOIN）实例
现在，我们希望列出所有的人，以及他们的定购 - 如果有的话。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderNo <span class="token keyword">FROM</span> Persons
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Orders <span class="token keyword">ON</span> Persons<span class="token punctuation">.</span>Id_P<span class="token operator">=</span>Orders<span class="token punctuation">.</span>Id_P 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Persons<span class="token punctuation">.</span>LastName

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>OrderNo</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>22456</td></tr> <tr><td>Adams</td> <td>John</td> <td>24562</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>77895</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>44678</td></tr> <tr><td>Bush</td> <td>George</td> <td></td></tr></tbody></table> <p>LEFT JOIN 关键字会从左表 (Persons) 那里返回所有的行，即使在右表 (Orders) 中没有匹配的行。</p> <hr> <h3 id="sql-right-join"><a href="#sql-right-join" class="header-anchor">#</a> SQL right join</h3> <p>RIGHT JOIN 关键字会右表 (table_name2) 那里返回所有的行，即使在左表 (table_name1) 中没有</p> <p>匹配的行。RIGHT JOIN 关键字语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name1
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> table_name2 <span class="token keyword">ON</span> table_name1<span class="token punctuation">.</span>column_name<span class="token operator">=</span>table_name2<span class="token punctuation">.</span>column_name
注释：在某些数据库中， <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> 称为 <span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>。

</code></pre></div><p>原始的表 (用在例子中的)：
&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id_P</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>Id_O</th> <th>OrderNo</th> <th>Id_P</th></tr></thead> <tbody><tr><td>1</td> <td>77895</td> <td>3</td></tr> <tr><td>2</td> <td>44678</td> <td>3</td></tr> <tr><td>3</td> <td>22456</td> <td>1</td></tr> <tr><td>4</td> <td>24562</td> <td>1</td></tr> <tr><td>5</td> <td>34764</td> <td>65</td></tr></tbody></table> <p>右连接（RIGHT JOIN）实例
现在，我们希望列出所有的定单，以及定购它们的人 - 如果有的话。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderNo
<span class="token keyword">FROM</span> Persons <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> OrdersON Persons<span class="token punctuation">.</span>Id_P<span class="token operator">=</span>Orders<span class="token punctuation">.</span>Id_P
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Persons<span class="token punctuation">.</span>LastName

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>OrderNo</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>22456</td></tr> <tr><td>Adams</td> <td>John</td> <td>24562</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>77895</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>44678</td></tr> <tr><td></td> <td></td> <td>34764</td></tr></tbody></table> <p>RIGHT JOIN 关键字会从右表 (Orders) 那里返回所有的行，即使在左表 (Persons) 中没有匹配的行。</p> <hr> <h3 id="sql-full-join"><a href="#sql-full-join" class="header-anchor">#</a> SQL full join</h3> <p>只要其中某个表存在匹配，FULL JOIN 关键字就会返回行。</p> <p>FULL JOIN 关键字语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name1
<span class="token keyword">FULL</span> <span class="token keyword">JOIN</span> table_name2
<span class="token keyword">ON</span> table_name1<span class="token punctuation">.</span>column_name<span class="token operator">=</span>table_name2<span class="token punctuation">.</span>column_name
注释：在某些数据库中， <span class="token keyword">FULL</span> <span class="token keyword">JOIN</span> 称为 <span class="token keyword">FULL</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>。

</code></pre></div><p>原始的表 (用在例子中的)：
&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id_P</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>Id_O</th> <th>OrderNo</th> <th>Id_P</th></tr></thead> <tbody><tr><td>1</td> <td>77895</td> <td>3</td></tr> <tr><td>2</td> <td>44678</td> <td>3</td></tr> <tr><td>3</td> <td>22456</td> <td>1</td></tr> <tr><td>4</td> <td>24562</td> <td>1</td></tr> <tr><td>5</td> <td>34764</td> <td>65</td></tr></tbody></table> <p>全连接（FULL JOIN）实例
现在，我们希望列出所有的人，以及他们的定单，以及所有的定单，以及定购它们的人。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderNo
<span class="token keyword">FROM</span> Persons <span class="token keyword">FULL</span> <span class="token keyword">JOIN</span> Orders <span class="token keyword">ON</span> Persons<span class="token punctuation">.</span>Id_P<span class="token operator">=</span>Orders<span class="token punctuation">.</span>Id_P
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Persons<span class="token punctuation">.</span>LastName

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>OrderNo</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td>22456</td></tr> <tr><td>Adams</td> <td>John</td> <td>24562</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>77895</td></tr> <tr><td>Carter</td> <td>Thomas</td> <td>44678</td></tr> <tr><td>Bush</td> <td>George</td> <td></td></tr> <tr><td></td> <td></td> <td>34764</td></tr></tbody></table> <p>FULL JOIN 关键字会从左表 (Persons) 和右表 (Orders) 那里返回所有的行。如果 &quot;Persons&quot; 中的行在表 &quot;Orders&quot; 中没有匹配，或者如果 &quot;Orders&quot; 中的行在表 &quot;Persons&quot; 中没有匹配，这些行同样会列出。</p> <hr> <h3 id="sql-union"><a href="#sql-union" class="header-anchor">#</a> SQL union</h3> <p>SQL UNION 操作符</p> <p>UNION 操作符用于合并两个或多个 SELECT 语句的结果集。请注意，UNION 内部的 SELECT 语句必须拥有相同数量的列。列也必须拥有相似的数据类型。同时，每条 SELECT 语句中的列的顺序必须相同。</p> <p>SQL UNION 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name1
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name2
注释：默认地，<span class="token keyword">UNION</span> 操作符选取不同的值。如果允许重复的值，请使用 <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>。

</code></pre></div><p>SQL UNION ALL 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name1
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name2

</code></pre></div><p>另外，UNION 结果集中的列名总是等于 UNION 中第一个 SELECT 语句中的列名。</p> <p>下面的例子中使用的原始表：</p> <p>Employees_China:</p> <table><thead><tr><th>E_ID</th> <th>E_Name</th></tr></thead> <tbody><tr><td>01</td> <td>Zhang, Hua</td></tr> <tr><td>02</td> <td>Wang, Wei</td></tr> <tr><td>03</td> <td>Carter, Thomas</td></tr> <tr><td>04</td> <td>Yang, Ming</td></tr></tbody></table> <p>Employees_USA:</p> <table><thead><tr><th>E_ID</th> <th>E_Name</th></tr></thead> <tbody><tr><td>01</td> <td>Adams, John</td></tr> <tr><td>02</td> <td>Bush, George</td></tr> <tr><td>03</td> <td>Carter, Thomas</td></tr> <tr><td>04</td> <td>Gates, Bill</td></tr></tbody></table> <p>使用 UNION 命令
列出所有在中国和美国的不同的雇员名：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> E_Name <span class="token keyword">FROM</span> Employees_China
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> E_Name <span class="token keyword">FROM</span> Employees_USA

</code></pre></div><p>结果</p> <table><thead><tr><th>E_Name</th> <th></th></tr></thead> <tbody><tr><td>Zhang, Hua</td> <td></td></tr> <tr><td>Wang, Wei</td> <td></td></tr> <tr><td>Carter, Thomas</td> <td></td></tr> <tr><td>Yang, Ming</td> <td></td></tr> <tr><td>Adams, John</td> <td></td></tr> <tr><td>Bush, George</td> <td></td></tr> <tr><td>Gates, Bill</td> <td></td></tr></tbody></table> <p>注释：这个命令无法列出在中国和美国的所有雇员。在上面的例子中，我们有两个名字相同的雇员，他们
当中只有一个人被列出来了。UNION 命令只会选取不同的值。</p> <p>UNION ALL 命令和 UNION 命令几乎是等效的，不过 UNION ALL 命令会列出所有的值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> Statement <span class="token number">1</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SQL</span> Statement <span class="token number">2</span>

</code></pre></div><p>使用 UNION ALL 命令
实例：
列出在中国和美国的所有的雇员：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> E_Name <span class="token keyword">FROM</span> Employees_China
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> E_Name <span class="token keyword">FROM</span> Employees_USA

</code></pre></div><p>结果</p> <table><thead><tr><th>E_Name</th></tr></thead> <tbody><tr><td>Zhang, Hua</td></tr> <tr><td>Wang, Wei</td></tr> <tr><td>Carter, Thomas</td></tr> <tr><td>Yang, Ming</td></tr> <tr><td>Adams, John</td></tr> <tr><td>Bush, George</td></tr> <tr><td>Carter, Thomas</td></tr> <tr><td>Gates, Bill</td></tr></tbody></table> <hr> <h3 id="sql-select-into"><a href="#sql-select-into" class="header-anchor">#</a> SQL select into</h3> <p>SQL SELECT INTO 语句可用于创建表的备份复件。</p> <p>SELECT INTO 语句从一个表中选取数据，然后把数据插入另一个表中。SELECT INTO 语句常用于创建表的备份复件或者用于对记录进行存档。</p> <p>SQL SELECT INTO 语法
您可以把所有的列插入新表：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">INTO</span> new_table_name <span class="token punctuation">[</span><span class="token operator">IN</span> externaldatabase<span class="token punctuation">]</span> <span class="token keyword">FROM</span> old_tablename

</code></pre></div><p>或者只把希望的列插入新表：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">INTO</span> new_table_name <span class="token punctuation">[</span><span class="token operator">IN</span> externaldatabase<span class="token punctuation">]</span> <span class="token keyword">FROM</span> old_tablename

</code></pre></div><p>SQL SELECT INTO 实例 -制作备份复件
下面的例子会制作 &quot;Persons&quot; 表的备份复件：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">INTO</span> Persons_backup <span class="token keyword">FROM</span> Persons

</code></pre></div><p>IN 子句可用于向另一个数据库中拷贝表：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">INTO</span> Persons <span class="token operator">IN</span> <span class="token string">'Backup.mdb'</span> <span class="token keyword">FROM</span> Persons

</code></pre></div><p>如果我们希望拷贝某些域，可以在 SELECT 语句后列出这些域：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LastName<span class="token punctuation">,</span>FirstNameINTO Persons_backup <span class="token keyword">FROM</span> Persons

</code></pre></div><p>SQL SELECT INTO 实例 - 带有 WHERE 子句
我们也可以添加 WHERE 子句。
下面的例子通过从 &quot;Persons&quot; 表中提取居住在 &quot;Beijing&quot; 的人的信息，创建了一个带有两个列的名为&quot;Persons_backup&quot; 的表：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LastName<span class="token punctuation">,</span>Firstname <span class="token keyword">INTO</span> Persons_backup
<span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> City<span class="token operator">=</span><span class="token string">'Beijing'</span>

</code></pre></div><p>SQL SELECT INTO 实例 - 被连接的表从一个以上的表中选取数据也是可以做到的。
下面的例子会创建一个名为 &quot;Persons_Order_Backup&quot; 的新表，其中包含了从 Persons 和 Orders两个表中取得的信息：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span>Orders<span class="token punctuation">.</span>OrderNo <span class="token keyword">INTO</span> Persons_Order_Backup
<span class="token keyword">FROM</span> Persons <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Orders <span class="token keyword">ON</span> Persons<span class="token punctuation">.</span>Id_P<span class="token operator">=</span>Orders<span class="token punctuation">.</span>Id_P

</code></pre></div><hr> <h3 id="sql-create-database"><a href="#sql-create-database" class="header-anchor">#</a> SQL create database</h3> <p>CREATE DATABASE 用于创建数据库。
SQL CREATE DATABASE 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> database_name

</code></pre></div><p>SQL CREATE DATABASE 实例
现在我们希望创建一个名为 &quot;my_db&quot; 的数据库。我们使用下面的 CREATE DATABASE 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> my_db

</code></pre></div><hr> <h3 id="sql-create-table"><a href="#sql-create-table" class="header-anchor">#</a> SQL create table</h3> <p>CREATE TABLE 语句用于创建数据库中的表。</p> <p>SQL CREATE TABLE 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名称
<span class="token punctuation">(</span>
列名称 <span class="token number">1</span> 数据类型<span class="token punctuation">,</span>
列名称 <span class="token number">2</span> 数据类型<span class="token punctuation">,</span>
列名称 <span class="token number">3</span> 数据类型<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span>

</code></pre></div><p>数据类型（data_type）规定了列可容纳何种数据类型。下面的表格包含了 SQL 中最常用的数据类型：</p> <table><thead><tr><th>数据类型</th> <th>描述</th></tr></thead> <tbody><tr><td>integer(size)、int(size)、smallint(size)、tinyint(size)</td> <td>仅容纳整数。在括号内规定数字的最大位数。</td></tr> <tr><td>decimal(size,d)、numeric(size,d)</td> <td>容纳带有小数的数字。&quot;size&quot; 规定数字的最大位数。&quot;d&quot; 规定小数点右侧的最大位数。</td></tr> <tr><td>char(size)</td> <td>容纳固定长度的字符串（可容纳字母、数字以及特殊字符）。在括号中规定字符串的长度。</td></tr> <tr><td>varchar(size)</td> <td>容纳可变长度的字符串（可容纳字母、数字以及特殊的字符）。在括号中规定字符串的最大长度。</td></tr> <tr><td>date(yyyymmdd)</td> <td>容纳日期。</td></tr></tbody></table> <p>SQL CREATE TABLE 实例
本例演示如何创建名为 &quot;Person&quot; 的表。
该表包含 5 个列，列名分别是：&quot;Id_P&quot;、&quot;LastName&quot;、&quot;FirstName&quot;、&quot;Address&quot; 以及 &quot;City&quot;：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>Id_P 列的数据类型是 int，包含整数。其余 4 列的数据类型是 varchar，最大长度为 255 个字符。
空的 &quot;Persons&quot; 表类似这样：</p> <table><thead><tr><th>Id_P</th> <th>LastName</th> <th style="text-align:left;">FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td></td> <td></td> <td style="text-align:left;"></td> <td></td> <td></td></tr></tbody></table> <hr> <h3 id="sql-约束"><a href="#sql-约束" class="header-anchor">#</a> SQL 约束</h3> <p>约束用于限制加入表的数据的类型。可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后也可以（通过 ALTER TABLE
语句）。</p> <p>我们将主要探讨以下几种约束：</p> <ul><li>NOT NULL</li> <li>UNIQUE</li> <li>PRIMARY KEY</li> <li>FOREIGN KEY</li> <li>CHECK</li> <li>DEFAULT</li></ul> <hr> <h3 id="sql-not-null"><a href="#sql-not-null" class="header-anchor">#</a> SQL not null</h3> <p>NOT NULL 约束强制列不接受 NULL 值。NOT NULL 约束强制字段始终包含值。这意味着，如果不向字段添加值，就无法插入新纪录或者更新记录。</p> <p>下面的 SQL 语句强制 &quot;Id_P&quot; 列和 &quot;LastName&quot; 列不接受 NULL 值：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><hr> <h3 id="sql-unique"><a href="#sql-unique" class="header-anchor">#</a> SQL unique</h3> <p>UNIQUE 约束唯一标识数据库表中的每条记录。UNIQUE 和 PRIMARY KEY 约束均为列或列集合提供了唯一性的保证。</p> <p>PRIMARY KEY 拥有自动定义的 UNIQUE 约束。</p> <p>请注意，每个表可以有多个 UNIQUE 约束，但是每个表只能有一个 PRIMARY KEY 约束。</p> <p>SQL UNIQUE Constraint on CREATE TABLE</p> <p>下面的 SQL 在 &quot;Persons&quot; 表创建时在 &quot;Id_P&quot; 列创建 UNIQUE 约束：</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>如果需要命名 UNIQUE 约束，以及为多个列定义 UNIQUE 约束</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> uc_PersonID <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>
<span class="token punctuation">)</span>


</code></pre></div><p>SQL UNIQUE Constraint on ALTER TABLE</p> <p>当表已被创建时，如需在 &quot;P_Id&quot; 列创建 UNIQUE 约束</p> <p>SQL：MySQL / SQL Server / Oracle / MS Access:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ADD</span> <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>P_Id<span class="token punctuation">)</span>

</code></pre></div><p>如需命名 UNIQUE 约束，并定义多个列的 UNIQUE 约束</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> uc_PersonID <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>P_Id<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>

</code></pre></div><p>如需撤销 UNIQUE 约束</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> uc_PersonID

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">DROP</span> <span class="token keyword">CONSTRAINT</span> uc_PersonID

</code></pre></div><hr> <h3 id="sql-primary-key"><a href="#sql-primary-key" class="header-anchor">#</a> SQL primary key</h3> <p>PRIMARY KEY 约束唯一标识数据库表中的每条记录。主键必须包含唯一的值。主键列不能包含 NULL 值。每个表应该都一个主键，并且每个表只能有一个主键。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">Constraint</span> <span class="token keyword">on</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>

</code></pre></div><p>下面的 SQL 在 &quot;Persons&quot; 表创建时在 &quot;Id_P&quot; 列创建 PRIMARY KEY 约束：</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>如果需要命名 PRIMARY KEY 约束，以及为多个列定义 PRIMARY KEY 约束，请使用下面的 SQL 语
法：</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> uc_PersonID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">Constraint</span> <span class="token keyword">on</span> <span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span>

</code></pre></div><p>如果在表已存在的情况下为 &quot;Id_P&quot; 列创建 PRIMARY KEY 约束</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>

</code></pre></div><p>如果需要命名 PRIMARY KEY 约束，以及为多个列定义 PRIMARY KEY 约束</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> pk_PersonID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span>
注释：如果您使用 <span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 语句添加主键，必须把主键列声明为不包含 <span class="token boolean">NULL</span> 值（在表首次创建时）。

</code></pre></div><p>撤销 PRIMARY KEY 约束</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons <span class="token keyword">DROP</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span>

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> PersonsDROP <span class="token keyword">CONSTRAINT</span> pk_PersonID

</code></pre></div><hr> <h3 id="sql-foreign-key"><a href="#sql-foreign-key" class="header-anchor">#</a> SQL foreign key</h3> <p>一个表中的 FOREIGN KEY 指向另一个表中的 PRIMARY KEY。</p> <p>让我们通过一个例子来解释外键。请看下面两个表：</p> <p>&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id_P</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>Id_O</th> <th>OrderNo</th> <th>Id_P</th></tr></thead> <tbody><tr><td>1</td> <td>77895</td> <td>3</td></tr> <tr><td>2</td> <td>44678</td> <td>3</td></tr> <tr><td>3</td> <td>22456</td> <td>1</td></tr> <tr><td>4</td> <td>24562</td> <td>1</td></tr></tbody></table> <p>请注意，&quot;Orders&quot; 中的 &quot;Id_P&quot; 列指向 &quot;Persons&quot; 表中的 &quot;Id_P&quot; 列。&quot;Persons&quot; 表中的 &quot;Id_P&quot; 列是 &quot;Persons&quot; 表中的 PRIMARY KEY。
&quot;Orders&quot; 表中的 &quot;Id_P&quot; 列是 &quot;Orders&quot; 表中的 FOREIGN KEY。</p> <p>FOREIGN KEY 约束用于预防破坏表之间连接的动作。
FOREIGN KEY 约束也能防止非法数据插入外键列，因为它必须是它指向的那个表中的值之一。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token keyword">Constraint</span> <span class="token keyword">on</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>

</code></pre></div><p>下面的 SQL 在 &quot;Orders&quot; 表创建时为 &quot;Id_P&quot; 列创建 FOREIGN KEY：</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Orders
<span class="token punctuation">(</span>O_Id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
OrderNo <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
Id_P <span class="token keyword">int</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>O_Id<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> Persons<span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Orders
<span class="token punctuation">(</span>
O_Id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
OrderNo <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
Id_P <span class="token keyword">int</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token keyword">REFERENCES</span> Persons<span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>如果需要命名 FOREIGN KEY 约束，以及为多个列定义 FOREIGN KEY 约束</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Orders
<span class="token punctuation">(</span>
O_Id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
OrderNo <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
Id_P <span class="token keyword">int</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>O_Id<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> fk_PerOrders <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>
<span class="token keyword">REFERENCES</span> Persons<span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token keyword">Constraint</span> <span class="token keyword">on</span> <span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span>

</code></pre></div><p>如果在 &quot;Orders&quot; 表已存在的情况下为 &quot;Id_P&quot; 列创建 FOREIGN KEY 约束，请使用下面的 SQL：</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Orders
<span class="token keyword">ADD</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>
<span class="token keyword">REFERENCES</span> Persons<span class="token punctuation">(</span>Id_P<span class="token punctuation">)</span>

</code></pre></div><p>如果需要命名 FOREIGN KEY 约束，以及为多个列定义 FOREIGN KEY 约束</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>ALTER TABLE Orders
ADD CONSTRAINT fk_PerOrders
FOREIGN KEY (Id_P)
REFERENCES Persons(Id_P)

</code></pre></div><p>撤销 FOREIGN KEY 约束</p> <p>如需撤销 FOREIGN KEY 约束，请使用下面的 SQL：</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Orders <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> fk_PerOrders

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Orders <span class="token keyword">DROP</span> <span class="token keyword">CONSTRAINT</span> fk_PerOrders

</code></pre></div><hr> <h3 id="sql-check"><a href="#sql-check" class="header-anchor">#</a> SQL check</h3> <p>CHECK 约束用于限制列中的值的范围。</p> <p>如果对单个列定义 CHECK 约束，那么该列只允许特定的值。
如果对一个表定义 CHECK 约束，那么此约束会在特定的列中对值进行限制。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">CHECK</span> <span class="token keyword">Constraint</span> <span class="token keyword">on</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>

</code></pre></div><p>下面的 SQL 在 &quot;Persons&quot; 表创建时为 &quot;Id_P&quot; 列创建 CHECK 约束。CHECK 约束规定 &quot;Id_P&quot; 列必须只包含大于 0 的整数。</p> <p><strong>My SQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CHECK</span> <span class="token punctuation">(</span>Id_P<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong> <re>
CREATE TABLE Persons
(
Id_P int NOT NULL CHECK (Id_P&gt;0),
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255)
)</re></p> <div class="language- extra-class"><pre class="language-text"><code>如果需要命名 CHECK 约束，以及为多个列定义 CHECK 约束，请使用下面的 SQL 语法：

**MySQL / SQL Server / Oracle / MS Access:**
​```sql
CREATE TABLE Persons(
Id_P int NOT NULL,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
CONSTRAINT chk_Person CHECK (Id_P&gt;0 AND City='Sandnes')
)

</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">CHECK</span> <span class="token keyword">Constraint</span> <span class="token keyword">on</span> <span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span>

</code></pre></div><p>如果在表已存在的情况下为 &quot;Id_P&quot; 列创建 CHECK 约束，请使用下面的 SQL：</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons <span class="token keyword">ADD</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>Id_P<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>

</code></pre></div><p>如果需要命名 CHECK 约束，以及为多个列定义 CHECK 约束，请使用下面的 SQL 语法：</p> <p><strong>MySQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> chk_Person <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>Id_P<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">AND</span> City<span class="token operator">=</span><span class="token string">'Sandnes'</span><span class="token punctuation">)</span>

</code></pre></div><p>撤销 CHECK 约束
如需撤销 CHECK 约束，请使用下面的 SQL：</p> <p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">DROP</span> <span class="token keyword">CONSTRAINT</span> chk_Person

</code></pre></div><hr> <h3 id="sql-default"><a href="#sql-default" class="header-anchor">#</a> SQL default</h3> <p>DEFAULT 约束用于向列中插入默认值。
如果没有规定其他的值，那么会将默认值添加到所有的新纪录。SQL DEFAULT Constraint on CREATE TABLE</p> <p>下面的 SQL 在 &quot;Persons&quot; 表创建时为 &quot;City&quot; 列创建 DEFAULT 约束：</p> <p><strong>My SQL / SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
Id_P <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">'Sandnes'</span>
<span class="token punctuation">)</span>

</code></pre></div><p>通过使用类似 GETDATE() 这样的函数，DEFAULT 约束也可以用于插入系统值：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Orders
<span class="token punctuation">(</span>
Id_O <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
OrderNo <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
Id_P <span class="token keyword">int</span><span class="token punctuation">,</span>
OrderDate <span class="token keyword">date</span> <span class="token keyword">DEFAULT</span> GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">Constraint</span> <span class="token keyword">on</span> <span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span>

</code></pre></div><p>如果在表已存在的情况下为 &quot;City&quot; 列创建 DEFAULT 约束，请使用下面的 SQL：</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ALTER</span> City <span class="token keyword">SET</span> <span class="token keyword">DEFAULT</span> <span class="token string">'SANDNES'</span><span class="token keyword">SQL</span> Server <span class="token operator">/</span> Oracle <span class="token operator">/</span> MS Access:
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> City <span class="token keyword">SET</span> <span class="token keyword">DEFAULT</span> <span class="token string">'SANDNES'</span>

</code></pre></div><p>撤销 DEFAULT 约束
如需撤销 DEFAULT 约束，请使用下面的 SQL：</p> <p><strong>MySQL:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ALTER</span> City <span class="token keyword">DROP</span> <span class="token keyword">DEFAULT</span>

</code></pre></div><p><strong>SQL Server / Oracle / MS Access:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons
<span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> City <span class="token keyword">DROP</span> <span class="token keyword">DEFAULT</span>

</code></pre></div><hr> <h3 id="sql-create-index"><a href="#sql-create-index" class="header-anchor">#</a> SQL create index</h3> <p>CREATE INDEX 语句用于在表中创建索引。<br>
在不读取整个表的情况下，索引使数据库应用程序可以更快地查找数据。</p> <p>索引
您可以在表中创建索引，以便更加快速高效地查询数据。<br>
用户无法看到索引，它们只能被用来加速搜索/查询。<br>
注释：更新一个包含索引的表需要比更新一个没有索引的表更多的时间，这是由于索引本身也需要更新。<br>
因此，理想的做法是仅仅在常常被搜索的列（以及表）上面创建索引。<br>
SQL CREATE INDEX 语法
在表上创建一个简单的索引。允许使用重复的值：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> 注释：<span class="token string">&quot;column_name&quot;</span> 规定需要索引的列。

</code></pre></div><p>SQL CREATE UNIQUE INDEX 语法
在表上创建一个唯一的索引。唯一的索引意味着两个行不能拥有相同的索引值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> 

</code></pre></div><p>CREATE INDEX 实例
本例会创建一个简单的索引，名为 &quot;PersonIndex&quot;，在 Person 表的 LastName 列：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> PersonIndex <span class="token keyword">ON</span> Person <span class="token punctuation">(</span>LastName<span class="token punctuation">)</span>

</code></pre></div><p>如果您希望以降序索引某个列中的值，您可以在列名称之后添加保留字 DESC：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> PersonIndex <span class="token keyword">ON</span> Person <span class="token punctuation">(</span>LastName <span class="token keyword">DESC</span><span class="token punctuation">)</span>

</code></pre></div><p>假如您希望索引不止一个列，您可以在括号中列出这些列的名称，用逗号隔开：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> PersonIndex <span class="token keyword">ON</span> Person <span class="token punctuation">(</span>LastName<span class="token punctuation">,</span> FirstName<span class="token punctuation">)</span>

</code></pre></div><hr> <h3 id="sql-drop"><a href="#sql-drop" class="header-anchor">#</a> SQL drop</h3> <p>通过使用 DROP 语句，可以轻松地删除索引、表和数据库。</p> <p>我们可以使用 DROP INDEX 命令删除表格中的索引。
用于 Microsoft SQLJet (以及 Microsoft Access) 的语法:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name用于 MS <span class="token keyword">SQL</span> Server 的语法:
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> table_name<span class="token punctuation">.</span>index_name

</code></pre></div><p>用于 IBM DB2 和 Oracle 语法:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name

</code></pre></div><p>用于 MySQL 的语法:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name

</code></pre></div><p>SQL DROP TABLE 语句</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> 语句用于删除表（表的结构、属性以及索引也会被删除）：
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> 表名称

</code></pre></div><p>SQL DROP DATABASE 语句</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> 语句用于删除数据库：
<span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> 数据库名称

</code></pre></div><p>SQL TRUNCATE TABLE 语句</p> <p>如果我们仅仅需要除去表内的数据，但并不删除表本身，那么我们该如何做呢？
请使用 TRUNCATE TABLE 命令（仅仅删除表格中的数据）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> 表名称

</code></pre></div><hr> <h3 id="sql-alter"><a href="#sql-alter" class="header-anchor">#</a> SQL alter</h3> <p>ALTER TABLE 语句用于在已有的表中添加、修改或删除列。</p> <p>如需在表中添加列，请使用下列语法:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_nameADD column_name datatype

</code></pre></div><p>要删除表中的列，请使用下列语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> column_name

</code></pre></div><p>注释：某些数据库系统不允许这种在数据库表中删除列的方式 (DROP COLUMN column_name)。
要改变表中列的数据类型，请使用下列语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
<span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> column_name datatype

</code></pre></div><p>Persons 表:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>SQL ALTER TABLE 实例
现在，我们希望在表 &quot;Persons&quot; 中添加一个名为 &quot;Birthday&quot; 的新列。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons <span class="token keyword">ADD</span> Birthday <span class="token keyword">date</span>

</code></pre></div><p>请注意，新列 &quot;Birthday&quot; 的类型是 date，可以存放日期。数据类型规定列中可以存放的数据的类型。
新的 &quot;Persons&quot; 表类似这样：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th> <th>Birthday</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td> <td></td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td> <td></td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td> <td></td></tr></tbody></table> <p>改变数据类型实例
现在我们希望改变 &quot;Persons&quot; 表中 &quot;Birthday&quot; 列的数据类型。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons <span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> Birthday <span class="token keyword">year</span>

</code></pre></div><p>请注意，&quot;Birthday&quot; 列的数据类型是 year，可以存放 2 位或 4 位格式的年份。</p> <p>接下来，我们删除 &quot;Person&quot; 表中的 &quot;Birthday&quot; 列：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Person <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> Birthday

</code></pre></div><p>Persons 表会成为这样:</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <hr> <h3 id="sql-increment"><a href="#sql-increment" class="header-anchor">#</a> SQL increment</h3> <p>Auto-increment 会在新纪录插入表中时生成一个唯一的数字。</p> <p>AUTO INCREMENT 字段
我们通常希望在每次插入新纪录时，自动地创建主键字段的值。我们可以在表中创建一个 auto-increment 字段。<br> <strong>用于 MySQL 的语法</strong></p> <p>下列 SQL 语句把 &quot;Persons&quot; 表中的 &quot;P_Id&quot; 列定义为 auto-increment 主键：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
P_Id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>P_Id<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>MySQL 使用 AUTO_INCREMENT 关键字来执行 auto-increment 任务。默认地，AUTO_INCREMENT 的开始值是 1，每条新纪录递增 1。</p> <p>要让 AUTO_INCREMENT 序列以其他的值起始</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> Persons <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">100</span>

</code></pre></div><p>要在 &quot;Persons&quot; 表中插入新纪录，我们不必为 &quot;P_Id&quot; 列规定值（会自动添加一个唯一的值）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Bill'</span><span class="token punctuation">,</span><span class="token string">'Gates'</span><span class="token punctuation">)</span>

</code></pre></div><p>上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新纪录。&quot;P_Id&quot; 会被赋予一个唯一的值。&quot;FirstName&quot;会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</p> <p><strong>用于 SQL Server 的语法</strong></p> <p>下列 SQL 语句把 &quot;Persons&quot; 表中的 &quot;P_Id&quot; 列定义为 auto-increment 主键：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
P_Id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>MS SQL 使用 IDENTITY 关键字来执行 auto-increment 任务。</p> <p>默认地，IDENTITY 的开始值是 1，每条新纪录递增 1。要规定 &quot;P_Id&quot; 列以 20 起始且递增 10，请把 identity 改为 IDENTITY(20,10) 要在 &quot;Persons&quot; 表中插入新纪录，我们不必为 &quot;P_Id&quot; 列规定值（会自动添加一个唯一的值）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Bill'</span><span class="token punctuation">,</span><span class="token string">'Gates'</span><span class="token punctuation">)</span>

</code></pre></div><p>上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新纪录。&quot;P_Id&quot; 会被赋予一个唯一的值。&quot;FirstName&quot;会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</p> <p><strong>用于 Access 的语法</strong></p> <p>下列 SQL 语句把 &quot;Persons&quot; 表中的 &quot;P_Id&quot; 列定义为 auto-increment 主键：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Persons
<span class="token punctuation">(</span>
P_Id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> AUTOINCREMENT<span class="token punctuation">,</span>
LastName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
FirstName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
Address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
City <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>MS Access 使用 AUTOINCREMENT 关键字来执行 auto-increment 任务。默认地，AUTOINCREMENT 的开始值是 1，每条新纪录递增 1。
要规定 &quot;P_Id&quot; 列以 20 起始且递增 10，请把 autoincrement 改为 AUTOINCREMENT(20,10) 要在 &quot;Persons&quot; 表中插入新纪录，我们不必为 &quot;P_Id&quot; 列规定值（会自动添加一个唯一的值）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Bill'</span><span class="token punctuation">,</span><span class="token string">'Gates'</span><span class="token punctuation">)</span>

</code></pre></div><p>上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新纪录。&quot;P_Id&quot; 会被赋予一个唯一的值。&quot;FirstName&quot;会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</p> <p><strong>用于 Oracle 的语法</strong></p> <p>在 Oracle 中，代码稍微复杂一点。您必须通过 sequence 对创建 auto-increment 字段（该对象生成数字序列）。</p> <p>请使用下面的 CREATE SEQUENCE 语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> SEQUENCE seq_person
MINVALUE <span class="token number">1</span>
<span class="token keyword">START</span> <span class="token keyword">WITH</span> <span class="token number">1</span>
INCREMENT <span class="token keyword">BY</span> <span class="token number">1</span>
CACHE <span class="token number">10</span>

</code></pre></div><p>上面的代码创建名为 seq_person 的序列对象，它以 1 起始且以 1 递增。该对象缓存 10 个值以提高
性能。CACHE 选项规定了为了提高访问速度要存储多少个序列值。
要在 &quot;Persons&quot; 表中插入新纪录，我们必须使用 nextval 函数（该函数从 seq_person 序列中取回下
一个值）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>P_Id<span class="token punctuation">,</span>FirstName<span class="token punctuation">,</span>LastName<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>seq_person<span class="token punctuation">.</span>nextval<span class="token punctuation">,</span><span class="token string">'Lars'</span><span class="token punctuation">,</span><span class="token string">'Monsen'</span><span class="token punctuation">)</span>

</code></pre></div><p>上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新纪录。&quot;P_Id&quot; 的赋值是来自 seq_person 序列的下一个数字。&quot;FirstName&quot; 会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</p> <hr> <h3 id="sql-view"><a href="#sql-view" class="header-anchor">#</a> SQL view</h3> <p>视图是可视化的表。</p> <p>SQL CREATE VIEW 语句</p> <p>什么是视图？</p> <p>在 SQL 中，视图是基于 SQL 语句的结果集的可视化的表。视图包含行和列，就像一个真实的表。视图中的字段就是来自一个或多个数据库中的真实的表中的字段。我们可以向视图添加 SQL 函数、WHERE 以及 JOIN 语句，我们也可以提交数据，就像这些来自于某个单一的表。</p> <p>注释：数据库的设计和结构不会受到视图中的函数、where 或 join 语句的影响。</p> <p>SQL CREATE VIEW 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> view_name <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_nameWHERE condition

</code></pre></div><p>注释：视图总是显示最近的数据。每当用户查询视图时，数据库引擎通过使用 SQL 语句来重建数据。</p> <p>SQL CREATE VIEW 实例</p> <p>可以从某个查询内部、某个存储过程内部，或者从另一个视图内部来使用视图。通过向视图添加函数、join等等，我们可以向用户精确地提交我们希望提交的数据。</p> <p>样本数据库 Northwind 拥有一些被默认安装的视图。视图 &quot;Current Product List&quot; 会从 Products 表列出所有正在使用的产品。这个视图使用下列 SQL 创建：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">Current</span> Product List<span class="token punctuation">]</span> ASSELECT ProductID<span class="token punctuation">,</span>ProductName <span class="token keyword">FROM</span> Products <span class="token keyword">WHERE</span> Discontinued<span class="token operator">=</span><span class="token keyword">No</span>

</code></pre></div><p>我们可以查询上面这个视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span><span class="token keyword">Current</span> Product List<span class="token punctuation">]</span>

</code></pre></div><p>Northwind 样本数据库的另一个视图会选取 Products 表中所有单位价格高于平均单位价格的产品：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span>Products Above Average Price<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice <span class="token keyword">FROM</span> Products
<span class="token keyword">WHERE</span> UnitPrice <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>UnitPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Products<span class="token punctuation">)</span>

</code></pre></div><p>我们可以像这样查询上面这个视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>Products Above Average Price<span class="token punctuation">]</span>

</code></pre></div><p>另一个来自 Northwind 数据库的视图实例会计算在 1997 年每个种类的销售总数。请注意，这个视图会从另一个名为 &quot;Product Sales for 1997&quot; 的视图那里选取数据：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span>Category Sales <span class="token keyword">For</span> <span class="token number">1997</span><span class="token punctuation">]</span> <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> CategoryName<span class="token punctuation">,</span><span class="token function">Sum</span><span class="token punctuation">(</span>ProductSales<span class="token punctuation">)</span> <span class="token keyword">AS</span> CategorySales
<span class="token keyword">FROM</span> <span class="token punctuation">[</span>Product Sales <span class="token keyword">for</span> <span class="token number">1997</span><span class="token punctuation">]</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CategoryName

</code></pre></div><p>我们可以像这样查询上面这个视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>Category Sales <span class="token keyword">For</span> <span class="token number">1997</span><span class="token punctuation">]</span>

</code></pre></div><p>我们也可以向查询添加条件。现在，我们仅仅需要查看 &quot;Beverages&quot; 类的全部销量：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>Category Sales <span class="token keyword">For</span> <span class="token number">1997</span><span class="token punctuation">]</span>
<span class="token keyword">WHERE</span> CategoryName<span class="token operator">=</span><span class="token string">'Beverages'</span>

</code></pre></div><p>SQL 更新视图
您可以使用下面的语法来更新视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> Syntax <span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> view_name <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> condition

</code></pre></div><p>现在，我们希望向 &quot;Current Product List&quot; 视图添加 &quot;Category&quot; 列。我们将通过下列 SQL 更新视图：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">Current</span> Product List<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> ProductID<span class="token punctuation">,</span>ProductName<span class="token punctuation">,</span>Category
<span class="token keyword">FROM</span> Products <span class="token keyword">WHERE</span> Discontinued<span class="token operator">=</span><span class="token keyword">No</span>

</code></pre></div><p>SQL 撤销视图
您可以通过 DROP VIEW 命令来删除视图。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SQL</span> <span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> Syntax <span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> view_name

</code></pre></div><hr> <h3 id="sql-date"><a href="#sql-date" class="header-anchor">#</a> SQL date</h3> <p>当我们处理日期时，最难的任务恐怕是确保所插入的日期的格式，与数据库中日期列的格式相匹配。只要数据包含的只是日期部分，运行查询就不会出问题。但是，如果涉及时间，情况就有点复杂了。在讨论日期查询的复杂性之前，我们先来看看最重要的内建日期处理函数。</p> <p><strong>MySQL Date 函数</strong>
下面的表格列出了 MySQL 中最重要的内建日期函数：</p> <table><thead><tr><th>函数</th> <th>描述</th></tr></thead> <tbody><tr><td>NOW()</td> <td>返回当前的日期和时间</td></tr> <tr><td>CURDATE()</td> <td>返回当前的日期</td></tr> <tr><td>CURTIME()</td> <td>返回当前的时间</td></tr> <tr><td>DATE()</td> <td>提取日期或日期/时间表达式的日期部分</td></tr> <tr><td>EXTRACT()</td> <td>返回日期/时间按的单独部分</td></tr> <tr><td>DATE_ADD()</td> <td>给日期添加指定的时间间隔</td></tr> <tr><td>DATE_SUB()</td> <td>从日期减去指定的时间间隔</td></tr> <tr><td>DATEDIFF()</td> <td>返回两个日期之间的天数</td></tr> <tr><td>DATE_FORMAT()</td> <td>用不同的格式显示日期/时间</td></tr></tbody></table> <p><strong>SQL Server Date 函数</strong>    	
下面的表格列出了 SQL Server 中最重要的内建日期函数：</p> <table><thead><tr><th>函数</th> <th>描述</th></tr></thead> <tbody><tr><td>GETDATE()</td> <td>返回当前日期和时间</td></tr> <tr><td>DATEPART()</td> <td>返回日期/时间的单独部分</td></tr> <tr><td>DATEADD()</td> <td>在日期中添加或减去指定的时间间隔</td></tr> <tr><td>DATEDIFF()</td> <td>返回两个日期之间的时间</td></tr> <tr><td>CONVERT()</td> <td>用不同的格式显示日期/时间</td></tr></tbody></table> <p><strong>SQL Date 数据类型</strong><br>
MySQL 使用下列数据类型在数据库中存储日期或日期/时间值：</p> <ul><li>DATE - 格式 YYYY-MM-DD</li> <li>DATETIME - 格式: YYYY-MM-DD HH:MM:SS</li> <li>TIMESTAMP - 格式: YYYY-MM-DD HH:MM:SS</li> <li>YEAR - 格式 YYYY 或 YYSQL Server</li></ul> <p>使用下列数据类型在数据库中存储日期或日期/时间值：</p> <ul><li>DATE - 格式 YYYY-MM-DD</li> <li>DATETIME - 格式: YYYY-MM-DD HH:MM:SS</li> <li>SMALLDATETIME - 格式: YYYY-MM-DD HH:MM:SS</li> <li>TIMESTAMP - 格式: 唯一的数字</li></ul> <p><strong>SQL 日期处理</strong></p> <p>如果不涉及时间部分，那么我们可以轻松地比较两个日期！
假设我们有下面这个 &quot;Orders&quot; 表：</p> <table><thead><tr><th>OrderId</th> <th>ProductName</th> <th>OrderDate</th></tr></thead> <tbody><tr><td>1</td> <td>computer</td> <td>2008-12-26</td></tr> <tr><td>2</td> <td>printer</td> <td>2008-12-26</td></tr> <tr><td>3</td> <td>electrograph</td> <td>2008-11-12</td></tr> <tr><td>4</td> <td>telephone</td> <td>2008-10-19</td></tr></tbody></table> <p>现在，我们希望从上表中选取 OrderDate 为 &quot;2008-12-26&quot; 的记录。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Orders <span class="token keyword">WHERE</span> OrderDate<span class="token operator">=</span><span class="token string">'2008-12-26'</span>

</code></pre></div><p>结果集：</p> <p>OrderId ProductName OrderDate
-----|------|-----
1 |computer |2008-12-26
3 |electrograph |2008-12-26</p> <p>现在假设 &quot;Orders&quot; 类似这样（请注意 &quot;OrderDate&quot; 列中的时间部分）：</p> <table><thead><tr><th>OrderId</th> <th>ProductName</th> <th>OrderDate</th></tr></thead> <tbody><tr><td>1</td> <td>computer</td> <td>2008-12-26 16:23:55</td></tr> <tr><td>2</td> <td>printer</td> <td>2008-12-26 10:45:26</td></tr> <tr><td>3</td> <td>electrograph</td> <td>2008-11-12 14:12:08</td></tr> <tr><td>4</td> <td>telephone</td> <td>2008-10-19 12:56:10</td></tr></tbody></table> <p>如果我们使用上面的 SELECT 语句：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Orders <span class="token keyword">WHERE</span> OrderDate<span class="token operator">=</span><span class="token string">'2008-12-26'</span>

</code></pre></div><p>那么我们得不到结果。这是由于该查询不含有时间部分的日期。
提示：如果您希望使查询简单且更易维护，那么请不要在日期中使用时间部分！</p> <hr> <h3 id="sql-null"><a href="#sql-null" class="header-anchor">#</a> SQL NULL</h3> <p>NULL 值是遗漏的未知数据。默认地，表的列可以存放 NULL 值。</p> <p>SQL NULL 值</p> <p>如果表中的某个列是可选的，那么我们可以在不向该列添加值的情况下插入新纪录或更新已有的记录。这意味着该字段将以 NULL 值保存。
NULL 值的处理方式与其他值不同。NULL 用作未知的或不适用的值的占位符。</p> <p>注释：无法比较 NULL 和 0；它们是不等价的。</p> <p>SQL 的 NULL 值处理 请看下面的 &quot;Persons&quot; 表：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td></td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td></td> <td>Beijing</td></tr></tbody></table> <p>假如 &quot;Persons&quot; 表中的 &quot;Address&quot; 列是可选的。这意味着如果在 &quot;Address&quot; 列插入一条不带值的记
录，&quot;Address&quot; 列会使用 NULL 值保存。</p> <p>那么我们如何测试 NULL 值呢？</p> <p>无法使用比较运算符来测试 NULL 值，比如 =, &lt;, 或者 &lt;&gt;。</p> <p>我们必须使用 IS NULL 和 IS NOT NULL 操作符。</p> <p>SQL IS NULL我们如何仅仅选取在 &quot;Address&quot; 列中带有 NULL 值的记录呢？</p> <p><strong>我们必须使用 IS NULL 操作符：</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LastName<span class="token punctuation">,</span>FirstName<span class="token punctuation">,</span>Address <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> Address <span class="token operator">IS</span> <span class="token boolean">NULL</span>

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th></tr></thead> <tbody><tr><td>Adams</td> <td>John</td> <td></td></tr> <tr><td>Carter</td> <td>Thomas</td> <td></td></tr></tbody></table> <p>提示：请始终使用 IS NULL 来查找 NULL 值。</p> <p>SQL IS NOT NULL</p> <p>我们如何选取在 &quot;Address&quot; 列中不带有 NULL 值的记录呢？</p> <p><strong>我们必须使用 IS NOT NULL 操作符：</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LastName<span class="token punctuation">,</span>FirstName<span class="token punctuation">,</span>Address <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> Address <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>

</code></pre></div><p>结果集：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th> <th>Address</th></tr></thead> <tbody><tr><td>Bush</td> <td>George Fifth</td> <td>Avenue</td></tr></tbody></table> <p>SQL NULL 函数</p> <p>SQL ISNULL()、NVL()、IFNULL() 和 COALESCE() 函数</p> <p>请看下面的 &quot;Products&quot; 表：</p> <table><thead><tr><th>P_Id</th> <th>ProductName</th> <th>UnitPrice</th> <th>UnitsInStock</th> <th>UnitsOnOrder</th></tr></thead> <tbody><tr><td>1</td> <td>computer</td> <td>699</td> <td>25</td> <td>15</td></tr> <tr><td>2</td> <td>printer</td> <td>365</td> <td>36</td> <td></td></tr> <tr><td>3</td> <td>telephone</td> <td>280</td> <td>159</td> <td>57</td></tr></tbody></table> <p>假如 &quot;UnitsOnOrder&quot; 是可选的，而且可以包含 NULL 值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>UnitsOnOrder<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Products

</code></pre></div><p>在上面的例子中，如果有 &quot;UnitsOnOrder&quot; 值是 NULL，那么结果是 NULL。微软的 ISNULL() 函数用于规定如何处理 NULL 值。NVL(), IFNULL() 和 COALESCE() 函数也可以达到相同的结果。
在这里，我们希望 NULL 值为 0。下面，如果 &quot;UnitsOnOrder&quot; 是 NULL，则不利于计算，因此如果值是 NULL 则 ISNULL() 返回 0。</p> <p><strong>SQL Server / MS Access</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>ISNULL<span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">FROM</span> Products

</code></pre></div><p><strong>Oracle</strong>
Oracle 没有 ISNULL() 函数。不过，我们可以使用 NVL() 函数达到相同的结果：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>NVL<span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> Products

</code></pre></div><p><strong>MySQL</strong>
MySQL 也拥有类似 ISNULL() 的函数。不过它的工作方式与微软的 ISNULL() 函数有点不同。
在 MySQL 中，我们可以使用 IFNULL() 函数，就像这样：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> Products

</code></pre></div><p>或者我们可以使用 COALESCE() 函数，就像这样：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span>UnitPrice<span class="token operator">*</span><span class="token punctuation">(</span>UnitsInStock<span class="token operator">+</span><span class="token keyword">COALESCE</span><span class="token punctuation">(</span>UnitsOnOrder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> Products

</code></pre></div><hr> <h2 id="sql-数据类型"><a href="#sql-数据类型" class="header-anchor">#</a> SQL 数据类型</h2> <h3 id="microsoft-access-数据类型"><a href="#microsoft-access-数据类型" class="header-anchor">#</a> Microsoft Access 数据类型</h3> <table><thead><tr><th>数据类型</th> <th>描述</th> <th>存储</th></tr></thead> <tbody><tr><td>Text</td> <td>用于文本或文本与数字的组合。最多 255 个字符。</td> <td></td></tr> <tr><td>Memo</td> <td>Memo 用于更大数量的文本。最多存储 65,536 个字符。注释：无法对 memo 字段进行排序。不过它们是可搜索的。</td> <td></td></tr> <tr><td>Byte</td> <td>允许 0 到 255 的数字。</td> <td>1 字节</td></tr> <tr><td>Integer</td> <td>允许介于 -32,768 到 32,767 之间的数字。</td> <td>2 字节</td></tr> <tr><td>Long</td> <td>允许介于 -2,147,483,648 与 2,147,483,647 之间的全部数字</td> <td>4 字节</td></tr> <tr><td>Single</td> <td>单精度浮点。处理大多数小数。</td> <td>4 字节</td></tr> <tr><td>Double</td> <td>双精度浮点。处理大多数小数。</td> <td>8 字节</td></tr> <tr><td>Currency</td> <td>用于货币。支持 15 位的元，外加 4 位小数。提示：您可以选择使用哪个国家的货币。</td> <td>8 字节</td></tr> <tr><td>AutoNumber</td> <td>AutoNumber 字段自动为每条记录分配数字，通常从 1 开始。</td> <td>4 字节</td></tr> <tr><td>Date/Time</td> <td>用于日期和时间</td> <td>8 字节</td></tr> <tr><td>Yes/No</td> <td>逻辑字段，可以显示为 Yes/No、True/False 或 On/Off。在代码中，使用常量 True 和 False （等价于 1 和 0）注释：Yes/No 字段中不允许 Null 值</td> <td>1 比特</td></tr> <tr><td>Ole Object</td> <td>可以存储图片、音频、视频或其他 BLOBs (Binary Large OBjects)</td> <td>最 多 1GB</td></tr> <tr><td>Hyperlink</td> <td>包含指向其他文件的链接，包括网页。</td> <td>4 字节</td></tr> <tr><td>Lookup</td> <td>允许你创建一个可从下列列表中进行选择的选项列表。</td> <td>4 字节</td></tr> <tr><td>Wizard</td> <td>允许你创建一个可从下列列表中进行选择的选项列表。</td> <td>4 字节</td></tr></tbody></table> <h3 id="mysql-数据类型"><a href="#mysql-数据类型" class="header-anchor">#</a> MySQL 数据类型</h3> <p>在 MySQL 中，有三种主要的类型：文本、数字和日期/时间类型。</p> <h5 id="text-类型："><a href="#text-类型：" class="header-anchor">#</a> Text 类型：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th></tr></thead> <tbody><tr><td>CHAR(size)</td> <td>保存固定长度的字符串（可包含字母、数字以及特殊字符）。在括号中指定字符串的长度。最多 255 个字符。</td></tr> <tr><td>VARCHAR(size)</td> <td>保存可变长度的字符串（可包含字母、数字以及特殊字符）。在括号中指定字符串的最大长度。最多 255 个字符。注释：如果值的长度大于 255，则被转换为 TEXT 类型。</td></tr> <tr><td>TINYTEXT</td> <td>存放最大长度为 255 个字符的字符串。</td></tr> <tr><td>TEXT</td> <td>存放最大长度为 65,535 个字符的字符串。</td></tr> <tr><td>BLOB</td> <td>用于 BLOBs (Binary Large OBjects)。存放最多 65,535 字节的数据。</td></tr> <tr><td>MEDIUMTEXT</td> <td>存放最大长度为 16,777,215 个字符的字符串。</td></tr> <tr><td>MEDIUMBLOB</td> <td>用于 BLOBs (Binary Large OBjects)。存放最多 16,777,215 字节的数据。</td></tr> <tr><td>LONGTEXT</td> <td>存放最大长度为 4,294,967,295 个字符的字符串。</td></tr> <tr><td>LONGBLOB</td> <td>用于 BLOBs (Binary Large OBjects)。存放最多 4,294,967,295 字节的数据。</td></tr> <tr><td>ENUM(x,y,z,etc.)</td> <td>允许你输入可能值的列表。可以在 ENUM 列表中列出最大 65535个值。如果列表中不存在插入的值，则插入空值。注释：这些值是按照你输入的顺序存储的。可以按照此格式输入可能的值：ENUM('X','Y','Z')</td></tr> <tr><td>SET</td> <td>与 ENUM 类似，SET 最多只能包含 64 个列表项，不过 SET 可存储一个以上的值。</td></tr></tbody></table> <h5 id="number-类型："><a href="#number-类型：" class="header-anchor">#</a> Number 类型：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th></tr></thead> <tbody><tr><td>TINYINT(size)</td> <td>-128 到 127 常规。0 到 255 无符号。在括号中规定最大位数。</td></tr> <tr><td>SMALLINT(size)</td> <td>-32768 到 32767 常规。0 到 65535 无符号。在括号中规定最大位数。</td></tr> <tr><td>MEDIUMINT(size)</td> <td>-8388608 到 8388607 普通。0 to 16777215 无符号。在括号中规定最大位数。</td></tr> <tr><td>INT(size)</td> <td>-2147483648 到 2147483647 常规。0 到 4294967295 无符号。在括号中规定最大位数。</td></tr> <tr><td>BIGINT(size)</td> <td>-9223372036854775808 到 9223372036854775807 常 规 。 0 到 18446744073709551615 无符号。在括号中规定最大位数。</td></tr> <tr><td>FLOAT(size,d)</td> <td>带有浮动小数点的小数字。在括号中规定最大位数。在 d 参数中规定小数点右侧的最大位数。</td></tr> <tr><td>DOUBLE(size,d)</td> <td>带有浮动小数点的大数字。在括号中规定最大位数。在 d 参数中规定小数点右侧的最大位数。</td></tr> <tr><td>DECIMAL(size,d)</td> <td>作为字符串存储的 DOUBLE 类型，允许固定的小数点。</td></tr></tbody></table> <p>这些整数类型拥有额外的选项 UNSIGNED。通常，整数可以是负数或正数。如果添加 UNSIGNED 属性，那么范围将从 0 开始，而不是某个负数。</p> <h5 id="date-类型："><a href="#date-类型：" class="header-anchor">#</a> Date 类型：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th></tr></thead> <tbody><tr><td>DATE()</td> <td>日期。格式：YYYY-MM-DD 注释：支持的范围是从 '1000-01-01' 到 '9999-12-31'</td></tr> <tr><td>DATETIME()</td> <td>日期和时间的组合。格式：YYYY-MM-DD HH:MM:SS注释：支持的范围是从 '1000-01-01 00:00:00' 到 '9999-12-31 23:59:59'</td></tr> <tr><td>TIMESTAMP()</td> <td>时间戳。TIMESTAMP 值使用 Unix 纪元('1970-01-01 00:00:00' UTC) 至今的描述来存储。格式：YYYY-MM-DD HH:MM:SS注释：支持的范围是从 '1970-01-01 00:00:01' UTC 到'2038-01-09 03:14:07' UTC</td></tr> <tr><td>TIME()</td> <td>时间。格式：HH:MM:SS 注释：支持的范围是从 '-838:59:59' 到 '838:59:59'</td></tr> <tr><td>YEAR()</td> <td>2 位或 4 位格式的年。注释：4 位格式所允许的值：1901 到 2155。2 位格式所允许的值：70 到 69，表示从 1970 到 2069。</td></tr></tbody></table> <p>即便 DATETIME 和 TIMESTAMP 返回相同的格式，它们的工作方式很不同。在 INSERT 或UPDATE 查询中，TIMESTAMP 自动把自身设置为当前的日期和时间。TIMESTAMP 也接受不同的格式，比如 YYYYMMDDHHMMSS、YYMMDDHHMMSS、YYYYMMDD 或 YYMMDD。</p> <h3 id="sql-server-数据类型"><a href="#sql-server-数据类型" class="header-anchor">#</a> SQL Server 数据类型</h3> <h5 id="character-字符串："><a href="#character-字符串：" class="header-anchor">#</a> Character 字符串：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th> <th>存储</th></tr></thead> <tbody><tr><td>char(n)</td> <td>固定长度的字符串。最多 8,000 个字符。</td> <td>n</td></tr> <tr><td>varchar(n)</td> <td>可变长度的字符串。最多 8,000 个字符。</td> <td>n</td></tr> <tr><td>varchar(max)</td> <td>可变长度的字符串。最多 1,073,741,824 个字符。</td> <td></td></tr> <tr><td>text</td> <td>可变长度的字符串。最多 2GB 字符数据。</td> <td></td></tr></tbody></table> <h5 id="unicode-字符串："><a href="#unicode-字符串：" class="header-anchor">#</a> Unicode 字符串：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th> <th>存储</th></tr></thead> <tbody><tr><td>nchar(n)</td> <td>固定长度的 Unicode 数据。最多 4,000 个字符。</td> <td></td></tr> <tr><td>nvarchar(n)</td> <td>可变长度的 Unicode 数据。最多 4,000 个字符。</td> <td></td></tr> <tr><td>nvarchar(max)</td> <td>可变长度的 Unicode 数据。最多 536,870,912 个字符。</td> <td></td></tr> <tr><td>ntext</td> <td>可变长度的 Unicode 数据。最多 2GB 字符数据</td> <td></td></tr></tbody></table> <h5 id="binary-类型："><a href="#binary-类型：" class="header-anchor">#</a> Binary 类型：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th> <th>存储</th></tr></thead> <tbody><tr><td>bit</td> <td>允许 0、1 或 NULL</td> <td></td></tr> <tr><td>binary(n)</td> <td>固定长度的二进制数据。最多 8,000 字节。</td> <td></td></tr> <tr><td>varbinary(n)</td> <td>可变长度的二进制数据。最多 8,000 字节。</td> <td></td></tr> <tr><td>varbinary(max)</td> <td>可变长度的二进制数据。最多 2GB 字节。</td> <td></td></tr> <tr><td>image</td> <td>可变长度的二进制数据。最多 2GB。</td> <td></td></tr></tbody></table> <h5 id="number-类型：-2"><a href="#number-类型：-2" class="header-anchor">#</a> Number 类型：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th> <th>存储</th></tr></thead> <tbody><tr><td>tinyint</td> <td>允许从 0 到 255 的所有数字。</td> <td>1 字节</td></tr> <tr><td>smallint</td> <td>允许从 -32,768 到 32,767 的所有数字。</td> <td>2 字节</td></tr> <tr><td>int</td> <td>允许从 -2,147,483,648 到 2,147,483,647 的所有数字。</td> <td>4 字节</td></tr> <tr><td>bigint</td> <td>允 许 介 于 -9,223,372,036,854,775,808 和9,223,372,036,854,775,807 之间的所有数字。</td> <td>8 字节</td></tr> <tr><td>decimal(p,s)</td> <td>固定精度和比例的数字。允许从 -10^38 +1 到 10^38 -1 之间的数字。p 参数指示可以存储的最大位数（小数点左侧和右侧）。p 必须是 1 到 38 之间的值。默认是 18。s 参数指示小数点右侧存储的最大位数。s 必须是 0 到 p之间的值。默认是 0。</td> <td>5-17 字节</td></tr> <tr><td>numeric(p,s)</td> <td>固定精度和比例的数字。允许从 -10^38 +1 到 10^38 -1 之间的数字。p 参数指示可以存储的最大位数（小数点左侧和右侧）。p 必须是 1 到 38 之间的值。默认是 18。s 参数指示小数点右侧存储的最大位数。s 必须是 0 到 p之间的值。默认是 0。</td> <td>5-17字节</td></tr> <tr><td>smallmoney</td> <td>介于 -214,748.3648 和 214,748.3647 之间的货币数据。</td> <td>4 字节</td></tr> <tr><td>money</td> <td>介于 -922,337,203,685,477.5808 和 922,337,203,685,477.5807 之间的货币数据。</td> <td>8 字节</td></tr> <tr><td>float(n)</td> <td>从 -1.79E + 308 到 1.79E + 308 的浮动精度数字数据。 参数 n 指示该字段保存 4 字节还是 8 字节。float(24) 保存 4 字节，而float(53) 保存 8 字节。n 的默认值是 53。</td> <td>4 或8 字节</td></tr> <tr><td>real</td> <td>从 -3.40E + 38 到 3.40E + 38 的浮动精度数字数据。</td> <td>4 字节</td></tr></tbody></table> <h5 id="date-类型：-2"><a href="#date-类型：-2" class="header-anchor">#</a> Date 类型：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th> <th>存储</th></tr></thead> <tbody><tr><td>datetime</td> <td>从 1753 年 1 月 1 日 到 9999 年 12 月 31 日，精度为 3.33毫秒。</td> <td>8 bytes</td></tr> <tr><td>datetime2</td> <td>从 1753 年 1 月 1 日 到 9999 年 12 月 31 日，精度为 100纳秒。</td> <td>6-8 bytes</td></tr> <tr><td>smalldatetime</td> <td>从 1900 年 1 月 1 日 到 2079 年 6 月 6 日，精度为 1 分钟。</td> <td>4 bytes</td></tr> <tr><td>date</td> <td>仅存储日期。从 0001 年 1 月 1 日 到 9999 年 12 月 31 日。</td> <td>3 bytes</td></tr> <tr><td>time</td> <td>仅存储时间。精度为 100 纳秒。</td> <td>3-5 bytes</td></tr> <tr><td>datetimeoffset</td> <td>与 datetime2 相同，外加时区偏移。</td> <td>8-10 bytes</td></tr> <tr><td>timestamp</td> <td>存储唯一的数字，每当创建或修改某行时，该数字会更新。timestamp基于内部时钟，不对应真实时间。每个表只能有一个 timestamp 变量</td> <td></td></tr></tbody></table> <h5 id="其他数据类型："><a href="#其他数据类型：" class="header-anchor">#</a> 其他数据类型：</h5> <table><thead><tr><th>数据类型</th> <th>描述</th></tr></thead> <tbody><tr><td>sql_variant</td> <td>存 储 最 多 8,000 字 节不 同 数 据 类 型的 数 据， 除 了 text 、 ntext 以及timestamp。</td></tr> <tr><td>uniqueidentifier</td> <td>存储全局标识符 (GUID)。</td></tr> <tr><td>xml</td> <td>存储 XML 格式化数据。最多 2GB。</td></tr> <tr><td>cursor</td> <td>存储对用于数据库操作的指针的引用。</td></tr> <tr><td>table</td> <td>存储结果集，供稍后处理。</td></tr></tbody></table> <hr> <h2 id="sql函数"><a href="#sql函数" class="header-anchor">#</a> SQL函数</h2> <p>SQL 拥有很多可用于计数和计算的内建函数。</p> <p>内建 SQL 函数的语法是：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">function</span><span class="token punctuation">(</span>列<span class="token punctuation">)</span> <span class="token keyword">FROM</span> 表
</code></pre></div><p>在 SQL 中，基本的函数类型和种类有若干种。函数的基本类型是：</p> <ul><li>Aggregate 函数</li> <li>Scalar 函数</li></ul> <hr> <h3 id="sql-aggregate-functions"><a href="#sql-aggregate-functions" class="header-anchor">#</a> SQL Aggregate functions</h3> <p>Aggregate 函数的操作面向一系列的值，并返回一个单一的值。</p> <p>注释：如果在 SELECT 语句的项目列表中的众多其它表达式中使用 SELECT 语句，则这个 SELECT 必须使用 GROUP BY 语句！</p> <p>&quot;Persons&quot; table</p> <table><thead><tr><th>Name</th> <th>Age</th></tr></thead> <tbody><tr><td>Adams, John</td> <td>38</td></tr> <tr><td>Bush, George</td> <td>33</td></tr> <tr><td>Carter, Thomas</td> <td>28</td></tr></tbody></table> <p><strong>MS Access 中的合计函数</strong></p> <table><thead><tr><th>函数</th> <th>描述</th></tr></thead> <tbody><tr><td>AVG(column)</td> <td>返回某列的平均值</td></tr> <tr><td>COUNT(column)</td> <td>返回某列的行数（不包括 NULL 值）</td></tr> <tr><td>COUNT(*)</td> <td>返回被选行数</td></tr> <tr><td>FIRST(column)</td> <td>返回在指定的域中第一个记录的值</td></tr> <tr><td>LAST(column)</td> <td>返回在指定的域中最后一个记录的值</td></tr> <tr><td>MAX(column)</td> <td>返回某列的最高值</td></tr> <tr><td>MIN(column)</td> <td>返回某列的最低值</td></tr> <tr><td>STDEV(column)</td> <td></td></tr> <tr><td>STDEVP(column)</td> <td></td></tr> <tr><td>SUM(column)</td> <td>返回某列的总和</td></tr> <tr><td>VAR(column)</td> <td></td></tr> <tr><td>VARP(column)</td> <td></td></tr></tbody></table> <p><strong>在 SQL Server 中的合计函数</strong></p> <table><thead><tr><th>函数</th> <th>描述</th></tr></thead> <tbody><tr><td>AVG(column)</td> <td>返回某列的行数</td></tr> <tr><td>BINARY_CHECKSUM</td> <td></td></tr> <tr><td>CHECKSUM</td> <td></td></tr> <tr><td>CHECKSUM_AGG</td> <td></td></tr> <tr><td>COUNT(column)</td> <td>返回某列的行数（不包括 NULL 值）</td></tr> <tr><td>COUNT(*)</td> <td>返回被选行数</td></tr> <tr><td>COUNT(DISTINCTcolumn)</td> <td>返回相异结果的数目</td></tr> <tr><td>FIRST(column)</td> <td>返回在指定的域中第一个记录的值（SQLServer2000 不支持）</td></tr> <tr><td>LAST(column)</td> <td>返回在指定的域中最后一个记录的值（SQLServer2000 不支持）</td></tr> <tr><td>MAX(column)</td> <td>返回某列的最高值</td></tr> <tr><td>MIN(column)</td> <td>返回某列的最低值</td></tr> <tr><td>STDEV(column)</td> <td></td></tr> <tr><td>STDEVP(column)</td> <td></td></tr> <tr><td>SUM(column)</td> <td>返回某列的总和</td></tr> <tr><td>VAR(column)</td> <td></td></tr> <tr><td>VARP(column)</td> <td></td></tr></tbody></table> <hr> <h3 id="scalar-函数"><a href="#scalar-函数" class="header-anchor">#</a> Scalar 函数</h3> <p>Scalar 函数的操作面向某个单一的值，并返回基于输入值的一个单一的值。</p> <p><strong>MS Access 中的 Scalar 函数</strong></p> <table><thead><tr><th>函数</th> <th>描述</th></tr></thead> <tbody><tr><td>UCASE(c)</td> <td>将某个域转换为大写</td></tr> <tr><td>LCASE(c)</td> <td>将某个域转换为小写</td></tr> <tr><td>MID(c,start[,end])</td> <td>从某个文本域提取字符</td></tr> <tr><td>LEN(c)</td> <td>返回某个文本域的长度</td></tr> <tr><td>INSTR(c,char)</td> <td>返回在某个文本域中指定字符的数值位置</td></tr> <tr><td>LEFT(c,number_of_char)</td> <td>返回某个被请求的文本域的左侧部分</td></tr> <tr><td>RIGHT(c,number_of_char)</td> <td>返回某个被请求的文本域的右侧部分</td></tr> <tr><td>ROUND(c,decimals)</td> <td>对某个数值域进行指定小数位数的四舍五入</td></tr> <tr><td>MOD(x,y)</td> <td>返回除法操作的余数</td></tr> <tr><td>NOW()</td> <td>返回当前的系统日期</td></tr> <tr><td>FORMAT(c,format)</td> <td>改变某个域的显示方式</td></tr> <tr><td>DATEDIFF(d,date1,date2)</td> <td>用于执行日期计算</td></tr></tbody></table> <hr> <h3 id="sql-avg-函数"><a href="#sql-avg-函数" class="header-anchor">#</a> SQL AVG 函数</h3> <p>定义和用法</p> <p>AVG 函数返回数值列的平均值。NULL 值不包括在计算中。</p> <p>SQL AVG() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>计算 &quot;OrderPrice&quot; 字段的平均值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> OrderAverage <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>OrderAverage</th> <th></th></tr></thead> <tbody><tr><td>950</td> <td></td></tr></tbody></table> <p>找到 OrderPrice 值高于 OrderPrice 平均值的客户。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Customer <span class="token keyword">FROM</span> Orders <span class="token keyword">WHERE</span> OrderPrice<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Orders<span class="token punctuation">)</span>
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>Customer</th> <th></th></tr></thead> <tbody><tr><td>Bush</td> <td></td></tr> <tr><td>Carter</td> <td></td></tr> <tr><td>Adams</td> <td></td></tr></tbody></table> <hr> <h3 id="sql-count-函数"><a href="#sql-count-函数" class="header-anchor">#</a> SQL COUNT() 函数</h3> <p>COUNT() 函数返回匹配指定条件的行数。</p> <p>SQL COUNT(column_name) 语法</p> <p>COUNT(column_name) 函数返回指定列的值的数目（NULL 不计入）：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>SQL COUNT(*) 语法</p> <p>COUNT(*) 函数返回表中的记录数：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>SQL COUNT(DISTINCT column_name) 语法
COUNT(DISTINCT column_name) 函数返回指定列的不同值的数目：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
注释：<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span><span class="token punctuation">)</span> 适用于 ORACLE 和 Microsoft <span class="token keyword">SQL</span> Server，但是无法用于 Microsoft Access。
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>计算客户 &quot;Carter&quot; 的订单数。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>Customer<span class="token punctuation">)</span> <span class="token keyword">AS</span> CustomerNilsen <span class="token keyword">FROM</span> Orders <span class="token keyword">WHERE</span> Customer<span class="token operator">=</span><span class="token string">'Carter'</span>
</code></pre></div><p>以上 SQL 语句的结果是 2，因为客户 Carter 共有 2 个订单：</p> <table><thead><tr><th>CustomerNilsen</th> <th></th></tr></thead> <tbody><tr><td>2</td> <td></td></tr></tbody></table> <p>如果我们省略 WHERE 子句，比如这样：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> NumberOfOrders <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>NumberOfOrders</th> <th></th></tr></thead> <tbody><tr><td>6</td> <td></td></tr></tbody></table> <p>这是表中的总行数。</p> <p>现在，我们希望计算 &quot;Orders&quot; 表中不同客户的数目。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> Customer<span class="token punctuation">)</span> <span class="token keyword">AS</span> NumberOfCustomers <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>NumberOfCustomers</th> <th></th></tr></thead> <tbody><tr><td>3</td> <td></td></tr></tbody></table> <p>这是 &quot;Orders&quot; 表中不同客户（Bush, Carter 和 Adams）的数目。</p> <hr> <h3 id="sql-first-函数"><a href="#sql-first-函数" class="header-anchor">#</a> SQL FIRST() 函数</h3> <p>FIRST() 函数返回指定的字段中第一个记录的值。提示：可使用 ORDER BY 语句对记录进行排序。</p> <p>SQL FIRST() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>我们希望查找 &quot;OrderPrice&quot; 列的第一个值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> FirstOrderPrice <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>FirstOrderPrice</th> <th></th></tr></thead> <tbody><tr><td>1000</td> <td></td></tr></tbody></table> <h3 id="sql-last-函数"><a href="#sql-last-函数" class="header-anchor">#</a> SQL LAST() 函数</h3> <p>LAST() 函数返回指定的字段中最后一个记录的值。提示：可使用 ORDER BY 语句对记录进行排序。</p> <p>SQL LAST() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>SQL LAST() 实例</p> <p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>我们希望查找 &quot;OrderPrice&quot; 列的最后一个值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> LastOrderPrice <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>LastOrderPrice</th> <th></th></tr></thead> <tbody><tr><td>100</td> <td></td></tr></tbody></table> <hr> <h3 id="sql-max-函数"><a href="#sql-max-函数" class="header-anchor">#</a> SQL MAX() 函数</h3> <p>MAX 函数返回一列中的最大值。NULL 值不包括在计算中。</p> <p>SQL MAX() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
注释：MIN 和 MAX 也可用于文本列，以获得按字母顺序排列的最高或最低值。<span class="token keyword">SQL</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 实例
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>我们希望查找 &quot;OrderPrice&quot; 列的最大值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> LargestOrderPrice <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>LargestOrderPrice</th> <th></th></tr></thead> <tbody><tr><td>2000</td> <td></td></tr></tbody></table> <hr> <h3 id="sql-min-函数"><a href="#sql-min-函数" class="header-anchor">#</a> SQL MIN() 函数</h3> <p>MIN 函数返回一列中的最小值。NULL 值不包括在计算中。</p> <p>SQL MIN() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
注释：MIN 和 MAX 也可用于文本列，以获得按字母顺序排列的最高或最低值。
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>&quot;OrderPrice&quot; 列的最小值。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> SmallestOrderPrice <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>SmallestOrderPrice</th> <th></th></tr></thead> <tbody><tr><td>100</td> <td></td></tr></tbody></table> <hr> <p>##SQL SUM() 函数</p> <p>SUM 函数返回数值列的总数（总额）。</p> <p>SQL SUM() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>查找 &quot;OrderPrice&quot; 字段的总数。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> OrderTotal <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>OrderTotal</th> <th></th></tr></thead> <tbody><tr><td>5700</td> <td></td></tr></tbody></table> <hr> <h3 id="sql-group-by-语句"><a href="#sql-group-by-语句" class="header-anchor">#</a> SQL GROUP BY 语句</h3> <p>合计函数 (比如 SUM) 常常需要添加 GROUP BY 语句。GROUP BY 语句用于结合合计函数，根据一个或多个列对结果集进行分组。</p> <p>SQL GROUP BY 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">,</span> aggregate_function<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> column_name operator <span class="token keyword">value</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column_name
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>查找每个客户的总金额（总订单）。使用 GROUP BY 语句对客户进行组合。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Customer<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Orders <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Customer
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>Customer</th> <th>SUM(OrderPrice)</th></tr></thead> <tbody><tr><td>Bush</td> <td>2000</td></tr> <tr><td>Carter</td> <td>1700</td></tr> <tr><td>Adams</td> <td>2000</td></tr></tbody></table> <p>让我们看一下如果省略 GROUP BY 会出现什么情况：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Customer<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Orders
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>Customer</th> <th>SUM(OrderPrice)</th></tr></thead> <tbody><tr><td>Bush</td> <td>5700</td></tr> <tr><td>Carter</td> <td>5700</td></tr> <tr><td>Bush</td> <td>5700</td></tr> <tr><td>Bush</td> <td>5700</td></tr> <tr><td>Adams</td> <td>5700</td></tr> <tr><td>Carter</td> <td>5700</td></tr></tbody></table> <p>上面的结果集不是我们需要的。
那么为什么不能使用上面这条 SELECT 语句呢？解释如下：上面的 SELECT 语句指定了两列Customer 和 SUM(OrderPrice)）。&quot;SUM(OrderPrice)&quot; 返回一个单独的值（&quot;OrderPrice&quot; 列的
总计），而 &quot;Customer&quot; 返回 6 个值（每个值对应 &quot;Orders&quot; 表中的每一行）。因此，我们得不到正确的结果。不过，您已经看到了，GROUP BY 语句解决了这个问题。</p> <p>对一个以上的列应用 GROUP BY 语句</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Customer<span class="token punctuation">,</span>OrderDate<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Orders <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Customer<span class="token punctuation">,</span>OrderDate
</code></pre></div><hr> <h3 id="sql-having-子句"><a href="#sql-having-子句" class="header-anchor">#</a> SQL HAVING 子句</h3> <p>在 SQL 中增加 HAVING 子句原因是，WHERE 关键字无法与合计函数一起使用。</p> <p>SQL HAVING 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">,</span> aggregate_function<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> column_name operator <span class="token keyword">value</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column_name
<span class="token keyword">HAVING</span> aggregate_function<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> operator <span class="token keyword">value</span>
</code></pre></div><p>&quot;Orders&quot; 表：</p> <table><thead><tr><th>O_Id</th> <th>OrderDate</th> <th>OrderPrice</th> <th>Customer</th></tr></thead> <tbody><tr><td>1</td> <td>2008/12/29</td> <td>1000</td> <td>Bush</td></tr> <tr><td>2</td> <td>2008/11/23</td> <td>1600</td> <td>Carter</td></tr> <tr><td>3</td> <td>2008/10/05</td> <td>700</td> <td>Bush</td></tr> <tr><td>4</td> <td>2008/09/28</td> <td>300</td> <td>Bush</td></tr> <tr><td>5</td> <td>2008/08/06</td> <td>2000</td> <td>Adams</td></tr> <tr><td>6</td> <td>2008/07/21</td> <td>100</td> <td>Carter</td></tr></tbody></table> <p>查找订单总金额少于 2000 的客户。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Customer<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Orders <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Customer
<span class="token keyword">HAVING</span> <span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2000</span>
</code></pre></div><p>结果集类似：</p> <table><thead><tr><th>Customer</th> <th>SUM(OrderPrice)</th></tr></thead> <tbody><tr><td>Carter</td> <td>1700</td></tr></tbody></table> <p>查找客户 &quot;Bush&quot; 或 &quot;Adams&quot; 拥有超过 1500 的订单总金额。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Customer<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Orders
<span class="token keyword">WHERE</span> Customer<span class="token operator">=</span><span class="token string">'Bush'</span> <span class="token operator">OR</span> Customer<span class="token operator">=</span><span class="token string">'Adams'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Customer
<span class="token keyword">HAVING</span> <span class="token function">SUM</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1500</span>
</code></pre></div><p>结果集：</p> <table><thead><tr><th>Customer</th> <th>SUM(OrderPrice)</th></tr></thead> <tbody><tr><td>Bush</td> <td>2000</td></tr> <tr><td>Adams</td> <td>2000</td></tr></tbody></table> <hr> <h3 id="sql-ucase-函数"><a href="#sql-ucase-函数" class="header-anchor">#</a> SQL UCASE() 函数</h3> <p>UCASE() 函数UCASE 函数把字段的值转换为大写。</p> <p>SQL UCASE() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">UCASE</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>选取 &quot;LastName&quot; 和 &quot;FirstName&quot; 列的内容，然后把 &quot;LastName&quot; 列转换为大写。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">UCASE</span><span class="token punctuation">(</span>LastName<span class="token punctuation">)</span> <span class="token keyword">as</span> LastName<span class="token punctuation">,</span>FirstName <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th></tr></thead> <tbody><tr><td>ADAMS</td> <td>John</td></tr> <tr><td>BUSH</td> <td>George</td></tr> <tr><td>CARTER</td> <td>Thomas</td></tr></tbody></table> <hr> <h3 id="sql-lcase-函数"><a href="#sql-lcase-函数" class="header-anchor">#</a> SQL LCASE() 函数</h3> <p>LCASE 函数把字段的值转换为小写。</p> <p>SQL LCASE() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LCASE</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>选取 &quot;LastName&quot; 和 &quot;FirstName&quot; 列的内容，然后把 &quot;LastName&quot; 列转换为小写。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LCASE</span><span class="token punctuation">(</span>LastName<span class="token punctuation">)</span> <span class="token keyword">as</span> LastName<span class="token punctuation">,</span>FirstName <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>LastName</th> <th>FirstName</th></tr></thead> <tbody><tr><td>adams</td> <td>John</td></tr> <tr><td>bush</td> <td>George</td></tr> <tr><td>carter</td> <td>Thomas</td></tr></tbody></table> <hr> <h3 id="sql-mid-函数"><a href="#sql-mid-函数" class="header-anchor">#</a> SQL MID() 函数</h3> <p>MID 函数用于从文本字段中提取字符。</p> <p>SQL MID() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MID</span><span class="token punctuation">(</span>column_name<span class="token punctuation">,</span><span class="token keyword">start</span><span class="token punctuation">[</span><span class="token punctuation">,</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>column_name</td> <td>必需。要提取字符的字段。</td></tr> <tr><td>start</td> <td>必需。规定开始位置（起始值是 1）。</td></tr> <tr><td>length</td> <td>可选。要返回的字符数。如果省略，则 MID() 函数返回剩余文本。</td></tr></tbody></table> <p>&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>从 &quot;City&quot; 列中提取前 3 个字符。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MID</span><span class="token punctuation">(</span>City<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> SmallCity <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>SmallCity</th> <th></th></tr></thead> <tbody><tr><td>Lon</td> <td></td></tr> <tr><td>New</td> <td></td></tr> <tr><td>Bei</td> <td></td></tr></tbody></table> <hr> <h3 id="sql-len-函数"><a href="#sql-len-函数" class="header-anchor">#</a> SQL LEN() 函数</h3> <p>LEN 函数返回文本字段中值的长度。</p> <p>SQL LEN() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LEN</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>&quot;Persons&quot; 表：</p> <table><thead><tr><th>Id</th> <th>LastName</th> <th>FirstName</th> <th>Address</th> <th>City</th></tr></thead> <tbody><tr><td>1</td> <td>Adams</td> <td>John</td> <td>Oxford Street</td> <td>London</td></tr> <tr><td>2</td> <td>Bush</td> <td>George</td> <td>Fifth Avenue</td> <td>New York</td></tr> <tr><td>3</td> <td>Carter</td> <td>Thomas</td> <td>Changan Street</td> <td>Beijing</td></tr></tbody></table> <p>取得 &quot;City&quot; 列中值的长度。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LEN</span><span class="token punctuation">(</span>City<span class="token punctuation">)</span> <span class="token keyword">as</span> LengthOfAddress <span class="token keyword">FROM</span> Persons
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>LengthOfCity</th> <th></th></tr></thead> <tbody><tr><td>6</td> <td></td></tr> <tr><td>8</td> <td></td></tr> <tr><td>7</td> <td></td></tr></tbody></table> <hr> <h3 id="sql-round-函数"><a href="#sql-round-函数" class="header-anchor">#</a> SQL ROUND() 函数</h3> <p>ROUND 函数用于把数值字段舍入为指定的小数位数。</p> <p>SQL ROUND() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>column_name<span class="token punctuation">,</span>decimals<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>column_name</td> <td>必需。要舍入的字段。</td></tr> <tr><td>decimals</td> <td>必需。规定要返回的小数位数。</td></tr></tbody></table> <p>&quot;Products&quot; 表：</p> <table><thead><tr><th>Prod_Id</th> <th>ProductName</th> <th>Unit</th> <th>UnitPrice</th></tr></thead> <tbody><tr><td>1</td> <td>gold</td> <td>1000 g</td> <td>32.35</td></tr> <tr><td>2</td> <td>silver</td> <td>000 g</td> <td>11.56</td></tr> <tr><td>3</td> <td>copper</td> <td>1000 g</td> <td>6.85</td></tr></tbody></table> <p>把名称和价格舍入为最接近的整数。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>UnitPrice<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> UnitPrice <span class="token keyword">FROM</span> Products
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>ProductName</th> <th>UnitPrice</th></tr></thead> <tbody><tr><td>gold</td> <td>32</td></tr> <tr><td>silver</td> <td>12</td></tr> <tr><td>copper</td> <td>7</td></tr></tbody></table> <hr> <h3 id="sql-now-函数"><a href="#sql-now-函数" class="header-anchor">#</a> SQL NOW() 函数</h3> <p>NOW 函数返回当前的日期和时间。</p> <p>SQL NOW() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><p>&quot;Products&quot; 表：</p> <table><thead><tr><th>Prod_Id</th> <th>ProductName</th> <th>Unit</th> <th>UnitPrice</th></tr></thead> <tbody><tr><td>1</td> <td>gold</td> <td>1000 g</td> <td>32.35</td></tr> <tr><td>2</td> <td>silver</td> <td>000 g</td> <td>11.56</td></tr> <tr><td>3</td> <td>copper</td> <td>1000 g</td> <td>6.85</td></tr></tbody></table> <p>显示当天的日期所对应的名称和价格。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span> UnitPrice<span class="token punctuation">,</span> <span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> PerDate <span class="token keyword">FROM</span> Products
</code></pre></div><p>结果集类似这样：</p> <table><thead><tr><th>ProductName</th> <th>UnitPrice</th> <th>PerDate</th></tr></thead> <tbody><tr><td>gold</td> <td>32.35</td> <td>12/29/2008 11:36:05 AM</td></tr> <tr><td>silver</td> <td>11.56</td> <td>12/29/2008 11:36:05 AM</td></tr> <tr><td>copper</td> <td>6.85</td> <td>12/29/2008 11:36:05 AM</td></tr></tbody></table> <hr> <h3 id="sql-format-函数"><a href="#sql-format-函数" class="header-anchor">#</a> SQL FORMAT() 函数</h3> <p>FORMAT 函数用于对字段的显示进行格式化。</p> <p>SQL FORMAT() 语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">FORMAT</span><span class="token punctuation">(</span>column_name<span class="token punctuation">,</span>format<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name
</code></pre></div><table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>column_name</td> <td>必需。要格式化的字段。</td></tr> <tr><td>format</td> <td>必需。规定格式。</td></tr></tbody></table> <p>&quot;Products&quot; 表：</p> <table><thead><tr><th>Prod_Id</th> <th>ProductName</th> <th>Unit</th> <th>UnitPrice</th></tr></thead> <tbody><tr><td>1</td> <td>gold</td> <td>1000 g</td> <td>32.35</td></tr> <tr><td>2</td> <td>silver</td> <td>000 g</td> <td>11.56</td></tr> <tr><td>3</td> <td>copper</td> <td>1000 g</td> <td>6.85</td></tr></tbody></table> <p>显示每天日期所对应的名称和价格（日期的显示格式是 &quot;YYYY-MM-DD&quot;）。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ProductName<span class="token punctuation">,</span> UnitPrice<span class="token punctuation">,</span> <span class="token function">FORMAT</span><span class="token punctuation">(</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'YYYY-MM-DD'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> PerDate
</code></pre></div><p>FROM Products结果集类似这样：</p> <table><thead><tr><th>ProductName</th> <th>UnitPrice</th> <th>PerDate</th></tr></thead> <tbody><tr><td>gold</td> <td>32.35</td> <td>12/29/2008</td></tr> <tr><td>silver</td> <td>11.56</td> <td>12/29/2008</td></tr> <tr><td>copper</td> <td>6.85</td> <td>12/29/2008</td></tr></tbody></table> <hr> <section style="border-top:2px solid #eaecef;padding-top:1rem;margin-top:2rem;"><div><span data-flag-title="Your Article Title" class="leancloud-visitors"><em class="post-meta-item-text">阅读量： </em> <i class="leancloud-visitors-count"></i></span></div> <h3><a href="javascript:;"></a>
    评 论：
  </h3> <div id="vcomments"></div></section></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Hansiyuan131/hansiyuan131.github.io/edit/feature/docs/数据库/SQLServer/001SQL基础.md" target="_blank" rel="noopener noreferrer">编辑此文档</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/31/2020, 9:36:51 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/SQLServer/" class="prev router-link-active">
        SQLServer
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.d214fd8d.js" defer></script><script src="/assets/js/2.cb1efa29.js" defer></script><script src="/assets/js/39.9b5993f0.js" defer></script><script src="/assets/js/6.180eae89.js" defer></script><script src="/assets/js/3.86630006.js" defer></script>
  </body>
</html>
